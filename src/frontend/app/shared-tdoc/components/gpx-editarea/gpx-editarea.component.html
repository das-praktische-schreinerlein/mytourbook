<ng-container [formGroup]="editGpxFormGroup">
    <div class="row">
        <div class="col-sm-10 form-inline input-group input-group-sm">
            <label class="col-xs-3 col-form-label mr-2" i18n="gpxSrc label|Label for field: gpxSrc@@label.editform.tdoc.gpxSrc">Track:</label>
            <textarea formControlName="gpxSrc" id="gpxSrc" class="form-control nowrap" type="text" placeholder="gpxSrc"
                      (focusout)="updateGpsTrack()"
                      i18n-placeholder="gpsTrackSRc placeholder|Placeholder for gpxSrc@@placeholder.form.tdoc.gpxSrc"></textarea>
        </div>
        <div class="col-sm-2 form-inline input-group input-group-sm">
            <file-drop (onFileDrop)="gpxDropped($event)" i18n-headertext="gpsFileDropZone label|Label for button: gpsFileDropZone@@label.editform.tdoc.gpsFileDropZone">GPX-File dropzone</file-drop>

            <button (click)="fixMap()" i18n="fixGpsTrackSrc label|Label for button: fixGpsTrackSrc@@label.editform.tdoc.fixGpsTrackSrc">Fix errors</button>
        </div>
    </div>

    <ng-container *ngIf="trackSegmentStatistics.length > 0">
        <div class="row">
            <div class="col-sm-12 form-inline input-group input-group-sm">
                <label class="col-xs-3 col-form-label mr-2" i18n="trackSegmentStatistics label|Label for field: trackSegmentStatistics@@label.editform.tdoc.trackSegmentStatistics">Tracksegmente:</label>
                <table class="trackSegmentStatistics">
                    <tr>
                        <th i18n="trackSegments.color label|Label for field: trackSegments.color@@label.editform.tdoc.trackSegments.color"> </th>
                        <th i18n="trackSegmentStatistics.dateStart label|Label for field: trackSegmentStatistics.dateStart@@label.editform.tdoc.trackSegmentStatistics.dateStart">Von</th>
                        <th i18n="trackSegmentStatistics.dateEnd label|Label for field: trackSegmentStatistics.dateEnd@@label.editform.tdoc.trackSegmentStatistics.dateEnd">Bis</th>
                        <th i18n="trackSegmentStatistics.dist label|Label for field: trackSegmentStatistics.dist@@label.editform.tdoc.trackSegmentStatistics.dist">Länge</th>
                        <th i18n="trackSegmentStatistics.duration label|Label for field: trackSegmentStatistics.duration@@label.editform.tdoc.trackSegmentStatistics.duration">Dauer</th>
                        <th i18n="trackSegmentStatistics.altStart label|Label for field: trackSegmentStatistics.altStart@@label.editform.tdoc.trackSegmentStatistics.altStart">Starthöhe</th>
                        <th i18n="trackSegmentStatistics.altEnd label|Label for field: trackSegmentStatistics.altEnd@@label.editform.tdoc.trackSegmentStatistics.altEnd">Zielhöhe</th>
                        <th i18n="trackSegmentStatistics.actions label|Label for field: trackSegmentStatistics.actions@@label.editform.tdoc.trackSegmentStatistics.actions"> </th>
                    </tr>
                    <tbody>
                    <tr *ngFor="let trackSegmentStatistic of trackSegmentStatistics; let idx = index;">
                        <td [ngStyle]="{ background: (renderedMapElements.length > idx ? renderedMapElements[idx].color : '')}">&nbsp;</td>
                        <td>{{trackSegmentStatistic.dateStart | date:'medium'}}</td>
                        <td>{{trackSegmentStatistic.dateEnd | date:'medium'}}</td>
                        <td [ngClass]="trackSegmentStatistics[idx].dist > 60 ? 'trackhint' : ''">{{trackSegmentStatistic.dist}}km</td>
                        <td>{{trackSegmentStatistic.duration}}h</td>
                        <td>{{trackSegmentStatistic.altStart}}m</td>
                        <td>{{trackSegmentStatistic.altEnd}}m</td>
                        <td>
                            <button (click)="jumpToTrackSegment(idx)" class="btn btn-sm"
                                    *ngIf="renderedMapElements.length > idx && renderedMapElements[idx].type === 'TRACK'"
                                    [ngClass]="trackSegmentStatistics[idx].dist > 60 ? 'btn-action' : ''">
                                <span i18n="jumpToTrackSegment label|Label for button: jumpToTrackSegment@@label.editform.tdoc.jumpToTrackSegment">Focus</span>
                            </button>
                            <button (click)="deleteTrackSegment(idx)" class="btn btn-sm"
                                    *ngIf="renderedMapElements.length > idx && renderedMapElements[idx].type === 'TRACK'"
                                    i18n="deleteTrackSegment label|Label for button: deleteTrackSegment@@label.editform.tdoc.deleteTrackSegment">Delete</button>
                            <button *ngIf="idx > 0 && renderedMapElements.length > idx && renderedMapElements[idx].type === 'TRACK' && trackSegmentStatistics[idx].dateStart && trackSegmentStatistics[idx-1].dateEnd"
                                    (click)="mergeTrackSegment(idx)" class="btn btn-sm"
                                    [ngClass]="(trackSegmentStatistics[idx].dateStart.getTime() - trackSegmentStatistics[idx-1].dateEnd.getTime()) < 10*60*1000 ? 'btn-action' : ''">
                                <span i18n="mergeTrackSegment label|Label for button: mergeTrackSegment@@label.editform.tdoc.mergeTrackSegment">Merge</span>
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </ng-container>

    <ng-container *ngIf="trackStatistic.posStart !== undefined">
        <div class="row">
            <div class="col-sm-12 form-inline input-group input-group-sm">
                <div class="container content-container edit-map-container">
                    <app-tdoc-map [mapId]="'showMap'"
                                  [height]="'400px'"
                                  [mapZoom]="'9'"
                                  [tdocs]="editTrackRecords"
                                  (mapElementsFound)="setMapElementsRendered($event)"
                                  [trackColors]="trackColors"
                                  [showImageTrackAndGeoPos]="'true'"
                                  [mapCenterPos]="undefined"></app-tdoc-map>
                </div>
                <div class="container content-container edit-map-container">
                    <app-tdoc-profilemap [mapId]="'showProfileMap'"
                                         [height]="'400px'"
                                         [showImageTrackAndGeoPos]="'true'"
                                         [tdocs]="editTrackRecords"></app-tdoc-profilemap>
                </div>
            </div>
        </div>
    </ng-container>
</ng-container>
