patch-package
--- a/node_modules/@angular/cli/models/webpack-configs/common.js
+++ b/node_modules/@angular/cli/models/webpack-configs/common.js
@@ -158,7 +158,7 @@ function getCommonConfig(wco) {
     catch (e) { }
     return {
         resolve: {
-            extensions: ['.ts', '.js'],
+            extensions: ['@dps.js', '.ts', '.js'],
             modules: ['node_modules', nodeModules],
             symlinks: !buildOptions.preserveSymlinks,
             alias
--- a/node_modules/@angular/cli/models/webpack-configs/test.js
+++ b/node_modules/@angular/cli/models/webpack-configs/test.js
@@ -52,6 +52,8 @@ function getTestConfig(wco) {
             rules: [].concat(extraRules)
         },
         plugins: [
+            new webpack.NormalModuleReplacementPlugin(/knex/, 'node-noop'),
+            new webpack.NormalModuleReplacementPlugin(/redis/, 'node-noop'),
             new webpack.optimize.CommonsChunkPlugin({
                 minChunks: Infinity,
                 name: 'inline'
@@ -61,6 +63,7 @@ function getTestConfig(wco) {
                 chunks: ['main'],
                 minChunks: (module) => module.resource && module.resource.startsWith(nodeModules)
             })
+
         ].concat(extraPlugins)
     };
 }
