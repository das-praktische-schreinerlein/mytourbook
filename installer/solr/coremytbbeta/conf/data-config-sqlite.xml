<dataConfig>
    <dataSource type="JdbcDataSource"
                driver="org.sqlite.JDBC"
                url="${dataimport.sqlite.jdbcUrl}"
                user="${dataimport.sqlite.jdbcUser}"
                password="${dataimport.sqlite.jdbcPassword}"/>

    <document>

        <entity name="playlist"
                pk="id"
                query="
                    SELECT DISTINCT playlist.p_id,
                                    'PLAYLIST'                                                   AS type,
                                    playlist.p_calced_id                          AS id,
                                    playlist.countInfos,
                                    playlist.countImages,
                                    playlist.countLocations,
                                    playlist.countRoutes,
                                    playlist.countTracks,
                                    playlist.countTrips,
                                    playlist.countVideos,
                                    p_name,
                                    p_meta_desc,
                                    p_name  || ' ' || p_meta_desc AS html
                    FROM playlist WHERE p_id IN (SELECT p_id FROM image_playlist UNION SELECT p_id FROM video_playlist)
                    ORDER BY p_name"
                deltaImportQuery="
                    SELECT DISTINCT playlist.p_id,
                                    'PLAYLIST'                                                   AS type,
                                    playlist.p_calced_id                          AS id,
                                    playlist.countInfos,
                                    playlist.countImages,
                                    playlist.countLocations,
                                    playlist.countRoutes,
                                    playlist.countTracks,
                                    playlist.countTrips,
                                    playlist.countVideos,
                                    p_name,
                                    p_meta_desc,
                                    p_name || ' ' || p_meta_desc AS html
                    FROM playlist
                    WHERE playlist.p_id = '${dih.delta.id}'"
                deltaQuery="SELECT p_id FROM playlist ORDER BY p_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="p_id" name="playlist_id_i"/>
            <field column="p_id" name="playlist_id_is"/>

            <field column="p_name" name="name_s" stripHTML="true" />
            <field column="p_name" name="name_txt" stripHTML="true" />
            <field column="p_meta_desc" name="desc_txt" stripHTML="true" />
            <field column="p_meta_desc" name="desc_md_txt" stripHTML="false" />
            <field column="html" name="html_txt" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="countInfos" name="count_infos_i" />
            <field column="countImages" name="count_images_i" />
            <field column="countLocations" name="count_locations_i" />
            <field column="countRoutes" name="count_routes_i" />
            <field column="countTracks" name="count_tracks_i" />
            <field column="countTrips" name="count_trips_i" />
            <field column="countVideos" name="count_videos_i" />

            <!-- child='true' -->
            <entity name="playlist_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT "navid=PLAYLIST_" || p_id || ":::name=" || COALESCE(p_name, "null") || ":::navtype=" || "PREDECESSOR" AS navigation_objects
                            FROM playlist
                            WHERE p_name &lt; (SELECT p_name FROM playlist WHERE p_id IN (${playlist.p_id}))
                            ORDER BY p_name DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT "navid=PLAYLIST_" || p_id || ":::name=" || COALESCE(p_name, "null") || ":::navtype=" || "SUCCESSOR" AS navigation_objects
                            FROM playlist
                            WHERE p_name &gt; (SELECT p_name FROM playlist WHERE p_id IN (${playlist.p_id}))
                            ORDER BY p_name LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="playlist_extended_object_properties"
                    query='
                         SELECT "category=ENTITYCOUNT:::name=INFO_COUNT:::value=" || CAST(countInfos AS CHAR) AS extended_object_properties
                              FROM playlist
                              WHERE playlist.p_id IN (${playlist.p_id})
                            UNION
                         SELECT "category=ENTITYCOUNT:::name=IMAGE_COUNT:::value=" || CAST(countImages AS CHAR) AS extended_object_properties
                              FROM playlist
                              WHERE playlist.p_id IN (${playlist.p_id})
                            UNION
                         SELECT "category=ENTITYCOUNT:::name=LOCATION_COUNT:::value=" || CAST(countLocations AS CHAR) AS extended_object_properties
                              FROM playlist
                              WHERE playlist.p_id IN (${playlist.p_id})
                            UNION
                         SELECT "category=ENTITYCOUNT:::name=ROUTE_COUNT:::value=" || CAST(countRoutes AS CHAR) AS extended_object_properties
                              FROM playlist
                              WHERE playlist.p_id IN (${playlist.p_id})
                            UNION
                         SELECT "category=ENTITYCOUNT:::name=TRACK_COUNT:::value=" || CAST(countTracks AS CHAR) AS extended_object_properties
                              FROM playlist
                              WHERE playlist.p_id IN (${playlist.p_id})
                            UNION
                         SELECT "category=ENTITYCOUNT:::name=TRIP_COUNT:::value=" || CAST(countTrips AS CHAR) AS extended_object_properties
                              FROM playlist
                              WHERE playlist.p_id IN (${playlist.p_id})
                            UNION
                         SELECT "category=ENTITYCOUNT:::name=VIDEO_COUNT:::value=" || CAST(countVideos AS CHAR) AS extended_object_properties
                              FROM playlist
                              WHERE playlist.p_id IN (${playlist.p_id})
                    '>
                <field column="extended_object_properties" name="extended_object_properties_txt"/>
            </entity>

        </entity>

        <entity name="info"
                pk="id"
                query="
                    SELECT DISTINCT info.if_id,
                                    'INFO'                                                   AS type,
                                    info.if_calced_subtype                          AS subtype,
                                    info.if_calced_id                          AS id,
                                    info.l_id,
                                    info.countRoutes,
                                    info.countLocations,
                                    if_publisher,
                                    if_typ,
                                    if_url,
                                    if_name,
                                    if_meta_shortdesc,
                                    if_meta_desc,
                                    if_name || ' ' || if_keywords || ' ' || if_meta_shortdesc || ' ' || if_meta_desc AS html,
                                    if_keywords,
                                    l_lochirarchietxt,
                                    l_lochirarchieids
                    FROM info LEFT JOIN location ON info.l_id = location.l_id
                    ORDER BY if_name"
                deltaImportQuery="
                    SELECT DISTINCT info.if_id,
                                    'INFO'                                                   AS type,
                                    info.if_calced_subtype                          AS subtype,
                                    info.if_calced_id                          AS id,
                                    info.l_id,
                                    info.countRoutes,
                                    info.countLocations,
                                    if_publisher,
                                    if_typ,
                                    if_url,
                                    if_name,
                                    if_meta_shortdesc,
                                    if_meta_desc,
                                    if_name || ' ' || if_keywords || ' ' || if_meta_shortdesc || ' ' || if_meta_desc AS html,
                                    if_keywords,
                                    l_lochirarchietxt,
                                    l_lochirarchieids
                    FROM info LEFT JOIN location ON info.l_id = location.l_id
                    WHERE info.if_id = '${dih.delta.id}'"
                deltaQuery="SELECT if_id FROM info ORDER BY if_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="l_id" name="loc_id_i"/>
            <field column="l_id" name="loc_id_is"/>
            <field column="if_id" name="info_id_i"/>
            <field column="if_id" name="info_id_is"/>

            <field column="if_name" name="name_s" stripHTML="true" />
            <field column="if_name" name="name_txt" stripHTML="true" />
            <field column="if_publisher" name="info_publisher_s" stripHTML="true" />
            <field column="if_url" name="info_reference_s" stripHTML="true" />
            <field column="subtype" name="info_type_s" stripHTML="true" />
            <field column="if_meta_desc" name="desc_txt" stripHTML="true" />
            <field column="if_meta_desc" name="desc_md_txt" stripHTML="false" />
            <field column="html" name="html_txt" />
            <field column="if_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="dateonly" name="dateonly_s" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="subtype" name="subtype_s" />
            <field column="subtype" name="subtype_ss" />
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="countRoutes" name="count_routes_i" />
            <field column="countLocations" name="count_locations_i" />

            <!-- child='true' -->
            <entity name="info_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=INFO_" || if_id || ":::name=" || COALESCE(if_name, "null") || ":::navtype=PREDECESSOR") AS navigation_objects
                            FROM info
                            WHERE if_name &lt; (SELECT if_name FROM info WHERE if_id IN (${info.if_id}))
                            ORDER BY if_name DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=INFO_" || if_id || ":::name=" || COALESCE(if_name, "null") || ":::navtype=SUCCESSOR") AS navigation_objects
                            FROM info
                            WHERE if_name &gt; (SELECT if_name FROM info WHERE if_id IN (${info.if_id}))
                            ORDER BY if_name LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="info_extended_object_properties"
                    query='
                         SELECT "category=ENTITYCOUNT:::name=ROUTE_COUNT:::value=" || CAST(countRoutes AS CHAR) AS extended_object_properties
                              FROM info
                              WHERE info.if_id IN (${info.if_id})
                           UNION
                         SELECT "category=ENTITYCOUNT:::name=LOCATION_COUNT:::value=" || CAST(countLocations AS CHAR) AS extended_object_properties
                              FROM info
                              WHERE info.if_id IN (${info.if_id})
                    '>
                <field column="extended_object_properties" name="extended_object_properties_txt"/>
            </entity>

            <entity name="info_linkedplaylists"
                    query='
                        SELECT playlist.p_id, playlist.p_name, info_playlist.ifp_pos,
                           "type=playlist:::name=" || COALESCE(p_name, "null") || ":::refId=", CAST(playlist.p_id AS CHAR) ||
                           ":::position=" || COALESCE(info_playlist.ifp_pos, "null")
                          AS linkedplaylists
                          FROM playlist INNER JOIN info_playlist ON playlist.p_id = info_playlist.p_id WHERE info_playlist.if_id IN (${info.if_id})
                          ORDER BY p_name'>
                <field column="p_id" name="playlist_id_is"/>
                <field column="p_name" name="playlists_txt"/>
                <field column="ifp_pos" name="position_is"/>
                <field column="linkedplaylists" name="linkedplaylists_txt"/>
            </entity>

            <entity name="info_tour"
                    query="
                        SELECT tour.t_id, tour.d_id, t_keywords, tour.t_calced_actiontype AS actiontype
                          FROM info
                          INNER JOIN tour_info ON tour_info.if_id = info.if_id
                          INNER JOIN tour ON tour_info.t_id = tour.t_id
                          WHERE info.if_id IN (${info.if_id})"
                    deltaImportQuery="select t_id, t_keywords FROM tour WHERE t_id='${dih.delta.id}'"
                    deltaQuery="SELECT t_id FROM tour'"
            >
                <field column="t_id" name="route_id_is"/>
                <field column="d_id" name="destination_id_ss" />
                <field column="actiontype" name="actiontype_ss" />
            </entity>
            <entity name="info_destination"
                    query="
                        SELECT DISTINCT tour.d_id
                          FROM info
                          INNER JOIN tour_info ON tour_info.if_id = info.if_id
                          INNER JOIN tour ON tour_info.t_id = tour.t_id
                          WHERE info.if_id IN (${info.if_id})"
                    deltaImportQuery="select d_id, t_keywords FROM tour WHERE t_id='${dih.delta.id}'"
                    deltaQuery="SELECT t_id FROM tour'"
            >
                <field column="d_id" name="destination_id_ss"/>
            </entity>
            <entity name="info_location"
                    query="
                        SELECT location.l_id, l_lochirarchieids, l_lochirarchietxt
                          FROM info
                          INNER JOIN location_info ON location_info.if_id = info.if_id
                          INNER JOIN location ON location_info.l_id = location.l_id
                          WHERE info.if_id IN (${info.if_id})"
                    deltaImportQuery="select l_id FROM location WHERE l_id='${dih.delta.id}'"
                    deltaQuery="SELECT l_id FROM location'"
            >
                <field column="l_id" name="loc_id_is"/>
                <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
                <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
                <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
                <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            </entity>
            <entity name="info_destination"
                    query="
                        SELECT destination.d_id, d_keywords, destination.d_calced_actiontype AS actiontype
                          FROM info
                          INNER JOIN tour_info ON tour_info.if_id = info.if_id
                          INNER JOIN tour ON tour_info.t_id = tour.t_id
                          INNER JOIN destination ON destination.d_id=tour.d_id
                          WHERE info.if_id IN (${info.if_id})"
                    deltaImportQuery="select d_id, d_keywords FROM destination WHERE d_id='${dih.delta.id}'"
                    deltaQuery="SELECT d_id FROM destination"
            >
                <field column="destination.d_id" name="destination_id_ss" />
                <field column="actiontype" name="actiontype_ss" />
            </entity>
        </entity>

        <entity name="destination"
                pk="id"
                query="
                    SELECT 'DESTINATION'                                                                                             AS type,
                           destination.d_calced_actiontype                                                                           AS actiontype,
                           destination.d_calced_actiontype                          AS subtype,
                           destination.d_calced_id                          AS id,
                           destination.d_id,
                           destination.l_id,
                           destination.countImages,
                           destination.countImagesTop,
                           destination.countInfos,
                           destination.countNews,
                           destination.countRoutes,
                           destination.countTracks,
                           destination.countTrips,
                           destination.countVideos,
                           d_name,
                            d_name || ' ' || d_keywords || ' ' || l_lochirarchietxt AS html,
                           d_dateshow || 'Z' AS d_dateshow,
                           d_datevon || 'Z'                                                                                           AS datesort,
                           d_datevon || 'Z' AS d_datevon,
                           DATETIME(d_datevon)                                                     AS dateonly,
                           'DONE' || (d_datevon IS NOT NULL)                                                             AS done,
                           d_keywords,
                           d_rate_gesamt,
                           d_gps_lat,
                           d_gps_lon,
                           l_calced_gps_loc                                                                   AS d_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           d_k_ids,
                           `D_ELE_MAX`                                                                                         AS altMax,
                           `D_ROUTE_HM`                                                                                        AS altAsc,
                           `D_ROUTE_M`                                                                                         AS dist,
                           `D_ROUTE_DAUER`                                                                                     AS dur,
                           `D_RATE`                                                                                            AS overall,
                           `D_RATE_KS`                                                                                         AS ks,
                           `D_RATE_FIRN`                                                                                       AS firn,
                           `D_RATE_GLETSCHER`                                                                                  AS gletscher,
                           `D_RATE_KLETTERN`                                                                                   AS klettern,
                           `D_RATE_BERGTOUR`                                                                                   AS bergdestination,
                           `D_RATE_SCHNEESCHUH`                                                                                AS schneeschuh,
                           `D_RATE_AUSDAUER`                                                                                   AS ausdauer,
                           `D_RATE_BILDUNG`                                                                                    AS bildung,
                           `D_RATE_GESAMT`                                                                                     AS gesamt,
                           `D_RATE_KRAFT`                                                                                      AS kraft,
                           `D_RATE_MENTAL`                                                                                     AS mental,
                           `D_RATE_MOTIVE`                                                                                     AS motive,
                           `D_RATE_SCHWIERIGKEIT`                                                                              AS schwierigkeit,
                           `D_RATE_WICHTIGKEIT`                                                                                AS wichtigkeit,
                           D_calced_altAscFacet                                                       AS altAscFacet,
                           D_calced_altMaxFacet                                                               AS altMaxFacet,
                           D_calced_distFacet                                                        AS distFacet,
                           D_calced_durFacet                                                        AS durFacet,
                           D_DESC_GEBIET                                                                                       AS region,
                           D_DESC_ZIEL                                                                                         AS destloc
                    FROM destination,
                         location
                    WHERE destination.l_id = location.l_id
                    ORDER BY d_datevon, d_id"
                deltaImportQuery="
                    SELECT 'DESTINATION'                                                                                             AS type,
                           destination.d_calced_id                          AS id,
                           destination.d_id,
                           destination.l_id,
                           destination.countImages,
                           destination.countImagesTop,
                           destination.countInfos,
                           destination.countNews,
                           destination.countRoutes,
                           destination.countTracks,
                           destination.countTrips,
                           destination.countVideos,
                           d_name,
                            d_name || ' ' || d_keywords || ' ' || l_lochirarchietxt AS html,
                           d_dateshow || 'Z' AS d_dateshow,
                           d_datevon || 'Z'                                                                                          AS datesort,
                           d_datevon || 'Z' AS d_datevon,
                           DATETIME(d_datevon)                                                     AS dateonly,
                           'DONE' || (d_datevon IS NOT NULL)                                                             AS done,
                           d_keywords,
                           d_rate_gesamt,
                           d_gps_lat,
                           d_gps_lon,
                           l_calced_gps_loc                                                                   AS d_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           d_k_ids,
                           `D_ELE_MAX`                                                                                         AS altMax,
                           `D_ROUTE_HM`                                                                                        AS altAsc,
                           `D_ROUTE_M`                                                                                         AS dist,
                           `D_ROUTE_DAUER`                                                                                     AS dur,
                           `D_RATE`                                                                                            AS overall,
                           `D_RATE_KS`                                                                                         AS ks,
                           `D_RATE_FIRN`                                                                                       AS firn,
                           `D_RATE_GLETSCHER`                                                                                  AS gletscher,
                           `D_RATE_KLETTERN`                                                                                   AS klettern,
                           `D_RATE_BERGTOUR`                                                                                   AS bergdestination,
                           `D_RATE_SCHNEESCHUH`                                                                                AS schneeschuh,
                           `D_RATE_AUSDAUER`                                                                                   AS ausdauer,
                           `D_RATE_BILDUNG`                                                                                    AS bildung,
                           `D_RATE_GESAMT`                                                                                     AS gesamt,
                           `D_RATE_KRAFT`                                                                                      AS kraft,
                           `D_RATE_MENTAL`                                                                                     AS mental,
                           `D_RATE_MOTIVE`                                                                                     AS motive,
                           `D_RATE_SCHWIERIGKEIT`                                                                              AS schwierigkeit,
                           `D_RATE_WICHTIGKEIT`                                                                                AS wichtigkeit,
                           D_calced_altAscFacet                                                                AS altAscFacet,
                           D_calced_altMaxFacet                                                               AS altMaxFacet,
                           D_calced_distFacet                                                        AS distFacet,
                           D_calced_durFacet                                                        AS durFacet,
                           D_DESC_GEBIET                                                                                       AS region,
                           D_DESC_ZIEL                                                                                         AS destloc
                    FROM destination,
                         location
                    WHERE destination.l_id = location.l_id
                      AND destination.d_id = '${dih.delta.id}'"
                deltaQuery="SELECT D_id FROM destination ORDER BY d_datevon, d_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="k_id" name="track_id_i"/>
            <field column="k_id" name="track_id_is"/>
            <field column="d_id" name="destination_id_s"/>
            <field column="d_id" name="destination_id_ss"/>
            <field column="l_id" name="loc_id_i"/>
            <field column="l_id" name="loc_id_is"/>

            <field column="d_name" name="name_s" stripHTML="true" />
            <field column="d_name" name="name_txt" stripHTML="true" />
            <field column="html" name="html_txt" stripHTML="true" />
            <field column="d_meta_shortdesc_html" name="desc_txt" stripHTML="true" />
            <field column="d_meta_shortdesc_md" name="desc_md_txt" stripHTML="false" />
            <field column="d_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="d_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
            <field column="d_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            <field column="d_gpstracks_basefile" name="gpstracks_basefile_s" />
            <field column="dateonly" name="dateonly_s" />
            <field column="d_datevon" name="date_dt" />
            <field column="d_dateshow" name="dateshow_dt" />
            <field column="datesort" name="datesort_dt" />
            <field column="done" name="done_ss" />
            <field column="d_gps_lat" name="geo_lat_s" />
            <field column="d_gps_lon" name="geo_lon_s" />
            <field column="d_gps_loc" name="geo_loc_p" type="location" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="actiontype" name="actiontype_s" />
            <field column="actiontype" name="actiontype_ss" />
            <field column="subtype" name="subtype_s" />
            <field column="subtype" name="subtype_ss" />
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="altMax" name="data_tech_alt_max_i" />
            <field column="altAsc" name="data_tech_alt_asc_i" />
            <field column="dist" name="data_tech_dist_f" />
            <field column="dur" name="data_tech_dur_f" />
            <field column="region" name="data_info_region_s" />
            <field column="destloc" name="data_info_destloc_s" />
            <field column="baseloc" name="data_info_baseloc_s" />
            <field column="altAscFacet" name="data_tech_alt_asc_facet_is" />
            <field column="altMaxFacet" name="data_tech_alt_max_facet_is" />
            <field column="distFacet" name="data_tech_dist_facets_fs" />
            <field column="durFacet" name="data_tech_dur_facet_fs" />
            <field column="overall" name="rate_tech_overall_s" />
            <field column="ks" name="rate_tech_ks_s" />
            <field column="firn" name="rate_tech_firn_s" />
            <field column="gletscher" name="rate_tech_gletscher_s" />
            <field column="klettern" name="rate_tech_klettern_s" />
            <field column="bergtour" name="rate_tech_bergtour_s" />
            <field column="schneeschuh" name="rate_tech_schneeschuh_s" />
            <field column="overall" name="rate_tech_overall_ss" regex="[^-a-zA-Z0-9+.äöüßÄÖÜ]+" replaceWith=" "/>
            <field column="ausdauer" name="rate_pers_ausdauer_i" />
            <field column="bildung" name="rate_pers_bildung_i" />
            <field column="gesamt" name="rate_pers_gesamt_i" />
            <field column="kraft" name="rate_pers_kraft_i" />
            <field column="mental" name="rate_pers_mental_i" />
            <field column="motive" name="rate_pers_motive_i" />
            <field column="schwierigkeit" name="rate_pers_schwierigkeit_i" />
            <field column="wichtigkeit" name="rate_pers_wichtigkeit_i" />
            <field column="gesamt" name="rate_pers_gesamt_is" />
            <field column="schwierigkeit" name="rate_pers_schwierigkeit_is" />
            <field column="countImages" name="count_images_i" />
            <field column="countImagesTop" name="count_images_top_i" />
            <field column="countInfos" name="count_infos_i" />
            <field column="countNews" name="count_news_i" />
            <field column="countRoutes" name="count_routes_i" />
            <field column="countTracks" name="count_tracks_i" />
            <field column="countTrips" name="count_trips_i" />
            <field column="countVideos" name="count_videos_i" />

            <!-- child='true' -->
            <entity name="destination_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=DESTINATION_" || d_id || ":::name=" || COALESCE(d_name, "null") || ":::navtype=PREDECESSOR")  AS navigation_objects
                            FROM destination LEFT JOIN location ON destination.l_id = location.l_id
                            WHERE L_lochirarchietxt || d_name &lt;
                                (SELECT L_lochirarchietxt || d_name FROM destination LEFT JOIN location ON destination.l_id = location.l_id WHERE d_id IN ("${destination.d_id}"))
                            ORDER BY L_lochirarchietxt || d_name DESC, d_id DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=DESTINATION_" || d_id || ":::name=" || COALESCE(d_name, "null") || ":::navtype=SUCCESSOR")  AS navigation_objects
                            FROM destination LEFT JOIN location ON destination.l_id = location.l_id
                            WHERE L_lochirarchietxt || d_name &gt;
                                (SELECT L_lochirarchietxt || d_name FROM destination LEFT JOIN location ON destination.l_id = location.l_id WHERE d_id IN ("${destination.d_id}"))
                            ORDER BY L_lochirarchietxt || d_name, d_id LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="destination_extended_object_properties"
                    query='
                        SELECT "category=ENTITYCOUNT:::name=NEWS_COUNT:::value=" || CAST(countNews AS CHAR) AS extended_object_properties
                              FROM destination
                              WHERE destination.d_id IN ("${destination.d_id}")
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=ROUTE_COUNT:::value=" || CAST(countRoutes AS CHAR) AS extended_object_properties
                              FROM destination
                              WHERE destination.d_id IN ("${destination.d_id}")
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=INFO_COUNT:::value=" || CAST(countInfos AS CHAR) AS extended_object_properties
                              FROM destination
                              WHERE destination.d_id IN ("${destination.d_id}")
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=TRIP_COUNT:::value=" || CAST(countTrips AS CHAR) AS extended_object_properties
                              FROM destination
                              WHERE destination.d_id IN ("${destination.d_id}")
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=TRACK_COUNT:::value=" || CAST(countTracks AS CHAR) AS extended_object_properties
                              FROM destination
                              WHERE destination.d_id IN ("${destination.d_id}")
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_COUNT:::value=" || CAST(countImages AS CHAR) AS extended_object_properties
                              FROM destination
                              WHERE destination.d_id IN ("${destination.d_id}")
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_TOP_COUNT:::value=" || CAST(countImagesTop AS CHAR) AS extended_object_properties
                              FROM destination
                              WHERE destination.d_id IN ("${destination.d_id}")
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=VIDEO_COUNT:::value=" || CAST(countVideos AS CHAR) AS extended_object_properties
                              FROM destination
                              WHERE destination.d_id IN ("${destination.d_id}")
                    '>
                <field column="extended_object_properties" name="extended_object_properties_txt"/>
            </entity>

            <entity name="destination_image"
                    query="
                        SELECT
                             image.i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url, i_persons, i_objects
                        FROM image INNER JOIN kategorie_full ON image.k_id = kategorie_full.k_id
                             INNER JOIN tour ON tour.t_id=kategorie_full.t_id
                        WHERE
                            tour.d_id = '${destination.d_id}'
                                AND COALESCE(I_PERSONS, '') = ''
                            ORDER BY I_RATE_MOTIVE DESC, I_RATE_WICHTIGKEIT DESC, I_RATE DESC, image.I_ID DESC
                        limit 10"
                    deltaImportQuery="
                        SELECT i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url, i_persons, i_objects
                        FROM image WHERE i_id='${dih.delta.id}'"
                    deltaQuery="SELECT i_id FROM image'"
            >
                <field column="i_id" name="i_fav_id_is" />
                <field column="i_date" name="i_fav_i_date_dts" />
                <field column="i_url" name="i_fav_url_txt" />
                <field column="i_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="i_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            </entity>
            <entity name="destination_track"
                    query="
                        SELECT kategorie_full.k_id,
                               tr_id,
                               n_id,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               k_persons,
                               k_objects
                        FROM kategorie_full INNER JOIN kategorie_tour ON kategorie_tour.k_id = kategorie_full.k_id
                             INNER JOIN tour ON tour.t_id=kategorie_tour.t_id
                        WHERE
                            tour.d_id = '${destination.d_id}'
                        ORDER BY k_datevon asc"
                    deltaImportQuery="
                        SELECT kategorie_full.k_id,
                               tr_id,
                               n_id,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               k_persons,
                               k_objects
                        FROM kategorie_full
                        WHERE k_id = '${dih.delta.id}'"
                    deltaQuery="SELECT k_id FROM kategorie_full'"
            >
                <field column="k_id" name="track_id_is"/>
                <field column="tr_id" name="trip_id_is"/>
                <field column="n_id" name="news_id_is"/>
                <field column="k_datevon" name="date_dts" />
                <field column="week" name="week_is" />
                <field column="month" name="month_is" />
                <field column="year" name="year_is" />
                <field column="k_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            </entity>
            <entity name="destination_tour"
                    query="select t_id FROM tour WHERE d_id in ('${destination.d_id}')"
                    deltaImportQuery="select t_id FROM tour WHERE t_id='${dih.delta.id}'"
                    deltaQuery="SELECT t_id FROM tour'"
            >
                <field column="t_id" name="route_id_is"/>
            </entity>

            <entity name="destination_linkedinfos"
                    query='
                    SELECT "type=" || COALESCE(if_typ, "null") || ":::name=" || COALESCE(if_name, "null") ||
                        ":::refId=" || CAST(info.if_id AS CHAR) || ":::linkedDetails=" || COALESCE(tour_info.tif_linked_details, "null")
                        AS linkedinfos, info.if_id
                    FROM info INNER JOIN tour_info ON tour_info.if_id = info.if_id
                         INNER JOIN tour ON tour_info.t_id = tour.t_id
                    WHERE tour.d_id = "${destination.d_id}"
                        ORDER BY if_name'>
                <field column="if_id" name="info_id_is"/>
                <field column="linkedinfos" name="linkedinfos_txt"/>
            </entity>
            <entity name="destination_poi"
                    query="
                        SELECT poi.poi_id
                          FROM poi
                          INNER JOIN tour_poi ON tour_poi.poi_id = poi.poi_id
                          INNER JOIN tour ON tour_poi.t_id = tour.t_id
                          WHERE tour.d_id = '${destination.d_id}'"
                    deltaImportQuery="select poi_id FROM poi WHERE poi_id='${dih.delta.id}'"
                    deltaQuery="SELECT poi_id FROM poi'"
            >
                <field column="poi_id" name="poi_id_is"/>
            </entity>
        </entity>

        <entity name="track"
                pk="id"
                query="
                    SELECT 'TRACK'                                                                                        AS type,
                           kategorie_full.k_calced_actiontype                          AS actiontype,
                           kategorie_full.k_calced_actiontype                          AS subtype,
                           kategorie_full.k_calced_id                          AS id,
                           kategorie_full.k_id,
                           kategorie_full.t_id,
                           kategorie_full.d_id,
                           kategorie_full.k_t_ids,
                           kategorie_full.k_d_ids,
                           kategorie_full.tr_id,
                           kategorie_full.l_id,
                           kategorie_full.countImages,
                           kategorie_full.countImagesTop,
                           kategorie_full.countPois,
                           kategorie_full.countRoutes,
                           kategorie_full.countVideos,
                           n_id,
                           k_name,
                           k_html,
                           k_html || ' ' || k_name || ' ' || k_keywords || ' ' || k_meta_shortdesc_md || ' ' || l_lochirarchietxt AS html,
                           k_dateshow || 'Z' AS k_dateshow,
                           k_datevon || 'Z'                                                                                      AS datesort,
                           k_datevon || 'Z' AS k_datevon,
                           k_calced_dateonly                                                AS dateonly,
                           'DONE' || (k_datevon IS NOT NULL)                                                        AS done,
                           k_calced_week                                                                                AS week,
                           k_calced_month                                                                               AS month,
                           k_calced_year                                                                                AS year,
                           k_gpstracks_basefile,
                           k_gpstracks_state,
                           k_keywords,
                           k_persons,
                           k_objects,
                           k_meta_shortdesc_md,
                           k_meta_shortdesc_html,
                           k_meta_shortdesc_html                                                                          AS k_meta_shortdesc_html2,
                           k_rate_gesamt,
                           k_route_attr,
                           k_gps_lat,
                           k_gps_lon,
                           l_calced_gps_loc                                                              AS k_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           `K_ALTITUDE_ASC`                                                                               AS altAsc,
                           `K_ALTITUDE_DESC`                                                                              AS altDesc,
                           `K_ALTITUDE_MIN`                                                                               AS altMin,
                           `K_ALTITUDE_MAX`                                                                               AS altMax,
                           `K_DISTANCE`                                                                                   AS dist,
                           `K_RATE_AUSDAUER`                                                                              AS ausdauer,
                           `K_RATE_BILDUNG`                                                                               AS bildung,
                           `K_RATE_GESAMT`                                                                                AS gesamt,
                           `K_RATE_KRAFT`                                                                                 AS kraft,
                           `K_RATE_MENTAL`                                                                                AS mental,
                           `K_RATE_MOTIVE`                                                                                AS motive,
                           `K_RATE_SCHWIERIGKEIT`                                                                         AS schwierigkeit,
                           `K_RATE_WICHTIGKEIT`                                                                           AS wichtigkeit,
                           K_calced_altAscFacet                                                                AS altAscFacet,
                           K_calced_altMaxFacet                                                               AS altMaxFacet,
                           K_calced_distFacet                                                        AS distFacet,
                           K_calced_dur                                             AS dur,
                           K_calced_durFacet                                                        AS durFacet
                    FROM kategorie_full,
                         location
                    WHERE kategorie_full.l_id = location.l_id
                    ORDER BY k_datevon"
                deltaImportQuery="
                    SELECT 'TRACK'                                                                                        AS type,
                           kategorie_full.k_calced_actiontype                          AS actiontype,
                           kategorie_full.k_calced_actiontype                          AS subtype,
                           kategorie_full.k_calced_id                          AS id,
                           kategorie_full.k_id,
                           kategorie_full.t_id,
                           kategorie_full.d_id,
                           kategorie_full.k_t_ids,
                           kategorie_full.k_d_ids,
                           kategorie_full.l_id,
                           kategorie_full.countImages,
                           kategorie_full.countImagesTop,
                           kategorie_full.countPois,
                           kategorie_full.countRoutes,
                           kategorie_full.countVideos,
                           n_id,
                           k_name,
                           k_html,
                           k_html || ' ' || k_name || ' ' || k_keywords || ' ' || k_meta_shortdesc_md || ' ' || l_lochirarchietxt AS html,
                           k_dateshow || 'Z' AS k_dateshow,
                           k_datevon || 'Z'                                                                                      AS datesort,
                           k_datevon || 'Z' AS k_datevon,
                           k_calced_dateonly                                                AS dateonly,
                           'DONE' || (k_datevon IS NOT NULL)                                                        AS done,
                           k_calced_week                                                                                AS month,
                           k_calced_month                                                                               AS month,
                           k_calced_year                                                                                AS year,
                           k_gpstracks_basefile,
                           k_gpstracks_state,
                           k_keywords,
                           k_persons,
                           k_objects,
                           k_meta_shortdesc_md,
                           k_meta_shortdesc_html,
                           k_meta_shortdesc_html                                                                          AS k_meta_shortdesc_html2,
                           k_rate_gesamt,
                           k_gps_lat,
                           k_gps_lon,
                           l_calced_gps_loc                                                              AS k_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           `K_ALTITUDE_ASC`                                                                               AS altAsc,
                           `K_ALTITUDE_DESC`                                                                              AS altDesc,
                           `K_ALTITUDE_MIN`                                                                               AS altMin,
                           `K_ALTITUDE_MAX`                                                                               AS altMax,
                           `K_DISTANCE`                                                                                   AS dist,
                           `K_RATE_AUSDAUER`                                                                              AS ausdauer,
                           `K_RATE_BILDUNG`                                                                               AS bildung,
                           `K_RATE_GESAMT`                                                                                AS gesamt,
                           `K_RATE_KRAFT`                                                                                 AS kraft,
                           `K_RATE_MENTAL`                                                                                AS mental,
                           `K_RATE_MOTIVE`                                                                                AS motive,
                           `K_RATE_SCHWIERIGKEIT`                                                                         AS schwierigkeit,
                           `K_RATE_WICHTIGKEIT`                                                                           AS wichtigkeit,
                            K_calced_altAscFacet                                                                AS altAscFacet,
                            K_calced_altMaxFacet                                                               AS altMaxFacet,
                            K_calced_distFacet                                                        AS distFacet,
                            K_calced_dur                                             AS dur,
                            K_calced_durFacet                                                        AS durFacet
                    FROM kategorie_full,
                         location
                    WHERE kategorie_full.l_id = location.l_id
                      AND kategorie_full.k_id = '${dih.delta.id}'"
                deltaQuery="SELECT k_id FROM kategorie_full'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="k_id" name="track_id_i"/>
            <field column="k_id" name="track_id_is"/>
            <field column="tr_id" name="trip_id_i"/>
            <field column="tr_id" name="trip_id_is"/>
            <field column="t_id" name="route_id_i"/>
            <field column="t_id" name="route_id_is"/>
            <field column="d_id" name="destination_id_s"/>
            <field column="d_id" name="destination_id_ss"/>
            <field column="l_id" name="loc_id_i"/>
            <field column="l_id" name="loc_id_is"/>
            <field column="n_id" name="news_id_i"/>
            <field column="n_id" name="news_id_is"/>

            <field column="k_name" name="name_s" stripHTML="true" />
            <field column="k_name" name="name_txt" stripHTML="true" />
            <field column="html" name="html_txt" stripHTML="true" />
            <field column="k_meta_shortdesc_html" name="desc_txt" stripHTML="true" />
            <field column="k_meta_shortdesc_md" name="desc_md_txt" stripHTML="false" />
            <field column="k_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="k_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
            <field column="k_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            <field column="k_gpstracks_basefile" name="gpstracks_basefile_s" />
            <field column="k_gpstracks_state" name="gpstracks_state_i" />
            <field column="k_gpstracks_state" name="gpstracks_state_is" />
            <field column="k_datevon" name="date_dt" />
            <field column="k_dateshow" name="dateshow_dt" />
            <field column="datesort" name="datesort_dt" />
            <field column="dateonly" name="dateonly_s" />
            <field column="k_datevon" name="date_dts" />
            <field column="done" name="done_ss" />
            <field column="week" name="week_is" />
            <field column="month" name="month_is" />
            <field column="year" name="year_is" />
            <field column="k_gps_lat" name="geo_lat_s" />
            <field column="k_gps_lon" name="geo_lon_s" />
            <field column="k_gps_loc" name="geo_loc_p" type="location" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="actiontype" name="actiontype_s" />
            <field column="actiontype" name="actiontype_ss" />
            <field column="subtype" name="subtype_s" />
            <field column="subtype" name="subtype_ss" />
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="altAsc" name="data_tech_alt_asc_i" />
            <field column="altDesc" name="data_tech_alt_desc_i" />
            <field column="altMin" name="data_tech_alt_min_i" />
            <field column="altMax" name="data_tech_alt_max_i" />
            <field column="dist" name="data_tech_dist_f" />
            <field column="dur" name="data_tech_dur_f" />
            <field column="altAscFacet" name="data_tech_alt_asc_facet_is" />
            <field column="altMaxFacet" name="data_tech_alt_max_facet_is" />
            <field column="distFacet" name="data_tech_dist_facets_fs" />
            <field column="durFacet" name="data_tech_dur_facet_fs" />
            <field column="ausdauer" name="rate_pers_ausdauer_i" />
            <field column="bildung" name="rate_pers_bildung_i" />
            <field column="gesamt" name="rate_pers_gesamt_i" />
            <field column="kraft" name="rate_pers_kraft_i" />
            <field column="mental" name="rate_pers_mental_i" />
            <field column="motive" name="rate_pers_motive_i" />
            <field column="schwierigkeit" name="rate_pers_schwierigkeit_i" />
            <field column="wichtigkeit" name="rate_pers_wichtigkeit_i" />
            <field column="gesamt" name="rate_pers_gesamt_is" />
            <field column="schwierigkeit" name="rate_pers_schwierigkeit_is" />
            <field column="countImages" name="count_images_i" />
            <field column="countImagesTop" name="count_images_top_i" />
            <field column="countPois" name="count_pois_i" />
            <field column="countRoutes" name="count_routes_i" />
            <field column="countVideos" name="count_videos_i" />
            <field column="k_route_attr" name="route_attr_ss" />
            <field column="k_route_attr" name="route_attr_txt" />

            <!-- child='true' -->
            <entity name="track_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=TRACK_" || k_id || ":::name=" || COALESCE(k_name, "null") || ":::navtype=PREDECESSOR")  AS navigation_objects
                            FROM kategorie_full
                            WHERE k_datevon &lt; (SELECT k_datevon FROM kategorie_full WHERE k_id IN (${track.k_id}))
                            ORDER BY k_datevon DESC, k_id DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=TRACK_" || k_id || ":::name=" || COALESCE(k_name, "null") || ":::navtype=SUCCESSOR")  AS navigation_objects
                            FROM kategorie_full
                            WHERE k_datevon &gt; (SELECT k_datevon FROM kategorie_full WHERE k_id IN (${track.k_id}))
                            ORDER BY k_datevon, k_id LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="track_extended_object_properties"
                    query='
                        SELECT "category=ENTITYCOUNT:::name=ROUTE_COUNT:::value=" || CAST(countRoutes AS CHAR) AS extended_object_properties
                              FROM kategorie_full
                              WHERE kategorie_full.k_id IN (${track.k_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_COUNT:::value=" || CAST(countImages AS CHAR) AS extended_object_properties
                              FROM kategorie_full
                              WHERE kategorie_full.k_id IN (${track.k_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_TOP_COUNT:::value=" || CAST(countImagesTop AS CHAR) AS extended_object_properties
                              FROM kategorie_full
                              WHERE kategorie_full.k_id IN (${track.k_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=VIDEO_COUNT:::value=" || CAST(countVideos AS CHAR) AS extended_object_properties
                              FROM kategorie_full
                              WHERE kategorie_full.k_id IN (${track.k_id})
                        '>
                <field column="extended_object_properties" name="extended_object_properties_txt"/>
            </entity>

            <entity name="track_linkedplaylists"
                    query='
                        SELECT playlist.p_id, playlist.p_name, kategorie_playlist.kp_pos,
                           "type=playlist:::name=" || COALESCE(p_name, "null") || ":::refId=", CAST(playlist.p_id AS CHAR) ||
                           ":::position=" || COALESCE(kategorie_playlist.kp_pos, "null")
                          AS linkedplaylists
                          FROM playlist INNER JOIN kategorie_playlist ON playlist.p_id = kategorie_playlist.p_id WHERE kategorie_playlist.k_id IN (${track.k_id})
                          ORDER BY p_name'>
                <field column="p_id" name="playlist_id_is"/>
                <field column="p_name" name="playlists_txt"/>
                <field column="kp_pos" name="position_is"/>
                <field column="linkedplaylists" name="linkedplaylists_txt"/>
            </entity>

            <entity name="track_linkedroutes"
                    query='
                    SELECT * FROM (
                    SELECT "type=mainroute:::name=" || COALESCE(t_name, "null") || ":::refId=" || CAST(tour.t_id AS CHAR) ||
                       ":::full=true:::linkedRouteAttr=" || COALESCE(kategorie_full.k_route_attr, "null")
                      AS linkedroutes, k_route_attr as kt_route_attr
                      FROM tour INNER JOIN kategorie_full ON kategorie_full.t_id = tour.t_id WHERE kategorie_full.k_id IN (${track.k_id})
                    UNION
                    SELECT "type=subroute:::name=" || COALESCE(t_name, "null") || ":::refId=" || CAST(tour.t_id AS CHAR) ||
                       ":::full=" || CAST(COALESCE(kt_full, "false") AS CHAR) || ":::linkedRouteAttr=" || COALESCE(kategorie_tour.kt_route_attr, "null")
                      AS linkedroutes, kt_route_attr
                      FROM tour INNER JOIN kategorie_tour ON kategorie_tour.t_id = tour.t_id WHERE kategorie_tour.k_id IN (${track.k_id})
                    )  routessrc GROUP BY linkedroutes, kt_route_attr ORDER BY linkedroutes, kt_route_attr'>
                <field column="linkedroutes" name="linkedroutes_txt"/>
                <field column="kt_route_attr" name="route_attr_ss"/>
                <field column="kt_route_attr" name="route_attr_txt"/>
            </entity>

            <entity name="track_image"
                    query="
                        SELECT i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url, i_persons, i_objects
                        FROM image
                        WHERE k_id = '${track.k_id}'
                        ORDER BY I_RATE_MOTIVE desc, I_RATE_WICHTIGKEIT desc, I_RATE desc, I_ID desc
                        limit 10"
                    deltaImportQuery="
                        SELECT i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url, i_persons, i_objects
                        FROM image WHERE i_id='${dih.delta.id}'"
                    deltaQuery="SELECT i_id FROM image'"
            >
                <field column="i_id" name="i_fav_id_is" />
                <field column="i_date" name="i_fav_i_date_dts" />
                <field column="i_url" name="i_fav_url_txt" />
                <field column="i_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="i_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            </entity>
            <entity name="track_tour"
                    query="SELECT tour.t_id, d_id
                        FROM tour INNER JOIN kategorie_tour ON tour.t_id=kategorie_tour.t_id
                        WHERE kategorie_tour.k_id = ${track.k_id}"
                    deltaImportQuery="select t_id FROM tour WHERE t_id=${dih.delta.id}"
                    deltaQuery="SELECT t_id FROM tour'"
            >
                <field column="t_id" name="route_id_is"/>
                <field column="d_id" name="destination_id_ss"/>
            </entity>
            <entity name="track_destination"
                    query="select destination.d_id
                        FROM destination INNER JOIN tour ON tour.d_id=destination.d_id
                            INNER JOIN kategorie_tour ON kategorie_tour.t_id = tour.t_id
                        WHERE
                            kategorie_tour.k_id = ${track.k_id}"
                    deltaImportQuery="select d_id FROM destination WHERE d_id='${dih.delta.id}'"
                    deltaQuery="SELECT d_id FROM destination'"
            >
                <field column="d_id" name="destination_id_ss"/>
            </entity>
            <entity name="track_poi"
                    query="
                        SELECT poi.poi_id
                          FROM poi
                          INNER JOIN kategorie_poi ON kategorie_poi.poi_id = poi.poi_id
                          INNER JOIN kategorie_full ON kategorie_poi.k_id = kategorie_full.k_id
                          WHERE kategorie_full.k_id IN (${track.k_id})"
                    deltaImportQuery="select poi_id FROM poi WHERE poi_id='${dih.delta.id}'"
                    deltaQuery="SELECT poi_id FROM poi'"
            >
                <field column="poi_id" name="poi_id_is"/>
            </entity>
        </entity>

        <entity name="route"
                pk="id"
                query="
                    SELECT 'ROUTE'                                                                                             AS type,
                           tour.t_calced_actiontype                                                                           AS actiontype,
                           tour.t_calced_actiontype                          AS subtype,
                           tour.t_calced_id                          AS id,
                           tour.k_id,
                           tour.t_id,
                           tour.d_id,
                           tour.l_id,
                           tour.countImages,
                           tour.countImagesTop,
                           tour.countInfos,
                           tour.countNews,
                           tour.countTracks,
                           tour.countTrips,
                           tour.countVideos,
                           t_name,
                           t_html_list,
                           t_html_list || ' ' || t_name || ' ' || t_keywords || ' ' || t_meta_shortdesc_md || ' ' || l_lochirarchietxt AS html,
                           t_dateshow || 'Z' as t_dateshow,
                           t_datevon || 'Z'                                                                                           AS datesort,
                           t_datevon || 'Z' AS t_datevon,
                           t_calced_dateonly                                                    AS dateonly,
                           'DONE' || (t_datevon IS NOT NULL)                                                             AS done,
                           t_gpstracks_basefile,
                           t_gpstracks_state,
                           t_keywords,
                           t_persons,
                           t_objects,
                           t_meta_shortdesc_md,
                           t_meta_shortdesc_html,
                           t_meta_shortdesc_html                                                                               AS t_meta_shortdesc_html2,
                           t_rate_gesamt,
                           t_gps_lat,
                           t_gps_lon,
                           l_calced_gps_loc                                                       AS t_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           t_k_ids,
                           `T_ELE_MAX`                                                                                         AS altMax,
                           `T_ROUTE_HM`                                                                                        AS altAsc,
                           `T_ROUTE_M`                                                                                         AS dist,
                           `T_ROUTE_DAUER`                                                                                     AS dur,
                           `T_RATE`                                                                                            AS overall,
                           `T_RATE_KS`                                                                                         AS ks,
                           `T_RATE_FIRN`                                                                                       AS firn,
                           `T_RATE_GLETSCHER`                                                                                  AS gletscher,
                           `T_RATE_KLETTERN`                                                                                   AS klettern,
                           `T_RATE_BERGTOUR`                                                                                   AS bergtour,
                           `T_RATE_SCHNEESCHUH`                                                                                AS schneeschuh,
                           `T_RATE_AUSDAUER`                                                                                   AS ausdauer,
                           `T_RATE_BILDUNG`                                                                                    AS bildung,
                           `T_RATE_GESAMT`                                                                                     AS gesamt,
                           `T_RATE_KRAFT`                                                                                      AS kraft,
                           `T_RATE_MENTAL`                                                                                     AS mental,
                           `T_RATE_MOTIVE`                                                                                     AS motive,
                           `T_RATE_SCHWIERIGKEIT`                                                                              AS schwierigkeit,
                           `T_RATE_WICHTIGKEIT`                                                                                AS wichtigkeit,
                           T_calced_altAscFacet                                                                AS altAscFacet,
                           T_calced_altMaxFacet                                                               AS altMaxFacet,
                           T_calced_distFacet                                                        AS distFacet,
                           T_calced_durFacet                                                        AS durFacet,
                           T_CALCED_SECTIONS                                                                                   AS sectionsFacet,
                           T_DESC_FUEHRER_FULL                                                                                 AS guides,
                           T_DESC_GEBIET                                                                                       AS region,
                           T_DESC_TALORT                                                                                       AS baseloc,
                           T_DESC_ZIEL                                                                                         AS destloc,
                           T_DESC_SECTIONDETAILS                                                                               AS sectionDetails
                    FROM tour,
                         location
                    WHERE tour.l_id = location.l_id
                    ORDER BY t_datevon, t_id"
                deltaImportQuery="
                    SELECT 'ROUTE'                                                                                             AS type,
                           tour.t_calced_id                          AS id,
                           tour.k_id,
                           tour.t_id,
                           tour.d_id,
                           tour.l_id,
                           tour.countImages,
                           tour.countImagesTop,
                           tour.countInfos,
                           tour.countNews,
                           tour.countTracks,
                           tour.countTrips,
                           tour.countVideos,
                           t_name,
                           t_html_list,
                           t_html_list || ' ' || t_name || ' ' || t_keywords || ' ' || t_meta_shortdesc_md || ' ' || l_lochirarchietxt AS html,
                           t_dateshow || 'Z' AS t_dateshow,
                           t_datevon || 'Z'                                                                                           AS datesort,
                           t_datevon || 'Z' AS t_datevon,
                           t_calced_dateonly                                                     AS dateonly,
                           'DONE' || (t_datevon IS NOT NULL)                                                             AS done,
                           t_gpstracks_basefile,
                           t_gpstracks_state,
                           t_keywords,
                           t_persons,
                           t_objects,
                           t_meta_shortdesc_md,
                           t_meta_shortdesc_html,
                           t_meta_shortdesc_html                                                                               AS t_meta_shortdesc_html2,
                           t_rate_gesamt,
                           t_gps_lat,
                           t_gps_lon,
                           l_calced_gps_loc                                                       AS t_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           t_k_ids,
                           `T_ELE_MAX`                                                                                         AS altMax,
                           `T_ROUTE_HM`                                                                                        AS altAsc,
                           `T_ROUTE_M`                                                                                         AS dist,
                           `T_ROUTE_DAUER`                                                                                     AS dur,
                           `T_RATE`                                                                                            AS overall,
                           `T_RATE_KS`                                                                                         AS ks,
                           `T_RATE_FIRN`                                                                                       AS firn,
                           `T_RATE_GLETSCHER`                                                                                  AS gletscher,
                           `T_RATE_KLETTERN`                                                                                   AS klettern,
                           `T_RATE_BERGTOUR`                                                                                   AS bergtour,
                           `T_RATE_SCHNEESCHUH`                                                                                AS schneeschuh,
                           `T_RATE_AUSDAUER`                                                                                   AS ausdauer,
                           `T_RATE_BILDUNG`                                                                                    AS bildung,
                           `T_RATE_GESAMT`                                                                                     AS gesamt,
                           `T_RATE_KRAFT`                                                                                      AS kraft,
                           `T_RATE_MENTAL`                                                                                     AS mental,
                           `T_RATE_MOTIVE`                                                                                     AS motive,
                           `T_RATE_SCHWIERIGKEIT`                                                                              AS schwierigkeit,
                           `T_RATE_WICHTIGKEIT`                                                                                AS wichtigkeit,
                           T_calced_altAscFacet                                                                AS altAscFacet,
                           T_calced_altMaxFacet                                                               AS altMaxFacet,
                           T_calced_distFacet                                                        AS distFacet,
                           T_calced_durFacet                                                        AS durFacet,
                           T_CALCED_SECTIONS                                                                                   AS sectionsFacet,
                           T_DESC_FUEHRER_FULL                                                                                 AS guides,
                           T_DESC_GEBIET                                                                                       AS region,
                           T_DESC_TALORT                                                                                       AS baseloc,
                           T_DESC_ZIEL                                                                                         AS destloc,
                           T_DESC_SECTIONDETAILS                                                                               AS sectionDetails
                    FROM tour,
                         location
                    WHERE tour.l_id = location.l_id
                      AND tour.t_id = '${dih.delta.id}'"
                deltaQuery="SELECT T_id FROM tour ORDER BY t_datevon, t_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="k_id" name="track_id_i"/>
            <field column="k_id" name="track_id_is"/>
            <field column="t_id" name="route_id_i"/>
            <field column="t_id" name="route_id_is"/>
            <field column="d_id" name="destination_id_s"/>
            <field column="d_id" name="destination_id_ss"/>
            <field column="l_id" name="loc_id_i"/>
            <field column="l_id" name="loc_id_is"/>

            <field column="t_name" name="name_s" stripHTML="true" />
            <field column="t_name" name="name_txt" stripHTML="true" />
            <field column="html" name="html_txt" stripHTML="true" />
            <field column="t_meta_shortdesc_html" name="desc_txt" stripHTML="true" />
            <field column="t_meta_shortdesc_md" name="desc_md_txt" stripHTML="false" />
            <field column="t_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="t_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
            <field column="t_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            <field column="t_gpstracks_basefile" name="gpstracks_basefile_s" />
            <field column="t_gpstracks_state" name="gpstracks_state_i" />
            <field column="t_gpstracks_state" name="gpstracks_state_is" />
            <field column="dateonly" name="dateonly_s" />
            <field column="t_datevon" name="date_dt" />
            <field column="t_dateshow" name="dateshow_dt" />
            <field column="datesort" name="datesort_dt" />
            <field column="done" name="done_ss" />
            <field column="t_gps_lat" name="geo_lat_s" />
            <field column="t_gps_lon" name="geo_lon_s" />
            <field column="t_gps_loc" name="geo_loc_p" type="location" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="actiontype" name="actiontype_s" />
            <field column="actiontype" name="actiontype_ss" />
            <field column="subtype" name="subtype_s" />
            <field column="subtype" name="subtype_ss" />
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="altMax" name="data_tech_alt_max_i" />
            <field column="altAsc" name="data_tech_alt_asc_i" />
            <field column="dist" name="data_tech_dist_f" />
            <field column="dur" name="data_tech_dur_f" />
            <field column="sectionsFacet" name="data_tech_sections_s" />
            <field column="guides" name="data_info_guides_s" />
            <field column="region" name="data_info_region_s" />
            <field column="destloc" name="data_info_destloc_s" />
            <field column="baseloc" name="data_info_baseloc_s" />
            <field column="sectionDetails" name="data_info_section_details_s" />
            <field column="altAscFacet" name="data_tech_alt_asc_facet_is" />
            <field column="altMaxFacet" name="data_tech_alt_max_facet_is" />
            <field column="distFacet" name="data_tech_dist_facets_fs" />
            <field column="durFacet" name="data_tech_dur_facet_fs" />
            <field column="sectionsFacet" name="data_tech_sections_facet_ss" />
            <field column="overall" name="rate_tech_overall_s" />
            <field column="ks" name="rate_tech_ks_s" />
            <field column="firn" name="rate_tech_firn_s" />
            <field column="gletscher" name="rate_tech_gletscher_s" />
            <field column="klettern" name="rate_tech_klettern_s" />
            <field column="bergtour" name="rate_tech_bergtour_s" />
            <field column="schneeschuh" name="rate_tech_schneeschuh_s" />
            <field column="overall" name="rate_tech_overall_ss" regex="[^-a-zA-Z0-9+.äöüßÄÖÜ]+" replaceWith=" "/>
            <field column="ausdauer" name="rate_pers_ausdauer_i" />
            <field column="bildung" name="rate_pers_bildung_i" />
            <field column="gesamt" name="rate_pers_gesamt_i" />
            <field column="kraft" name="rate_pers_kraft_i" />
            <field column="mental" name="rate_pers_mental_i" />
            <field column="motive" name="rate_pers_motive_i" />
            <field column="schwierigkeit" name="rate_pers_schwierigkeit_i" />
            <field column="wichtigkeit" name="rate_pers_wichtigkeit_i" />
            <field column="gesamt" name="rate_pers_gesamt_is" />
            <field column="schwierigkeit" name="rate_pers_schwierigkeit_is" />
            <field column="countImages" name="count_images_i" />
            <field column="countImagesTop" name="count_images_top_i" />
            <field column="countInfos" name="count_infos_i" />
            <field column="countNews" name="count_news_i" />
            <field column="countTracks" name="count_tracks_i" />
            <field column="countTrips" name="count_trips_i" />
            <field column="countVideos" name="count_videos_i" />

            <!-- child='true' -->
            <entity name="route_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=ROUTE_" || t_id || ":::name=" || COALESCE(t_name, "null") || ":::navtype=PREDECESSOR")  AS navigation_objects
                            FROM tour LEFT JOIN location ON tour.l_id = location.l_id
                            WHERE L_lochirarchietxt || t_name &lt;
                                (SELECT L_lochirarchietxt || t_name FROM tour LEFT JOIN location ON tour.l_id = location.l_id WHERE t_id IN (${route.t_id}))
                            ORDER BY L_lochirarchietxt || t_name DESC, t_id DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=ROUTE_" || t_id || ":::name=" || COALESCE(t_name, "null") || ":::navtype=SUCCESSOR")  AS navigation_objects
                            FROM tour LEFT JOIN location ON tour.l_id = location.l_id
                            WHERE L_lochirarchietxt || t_name &gt;
                                (SELECT L_lochirarchietxt || t_name FROM tour LEFT JOIN location ON tour.l_id = location.l_id WHERE t_id IN (${route.t_id}))
                            ORDER BY L_lochirarchietxt || t_name, t_id LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="route_extended_object_properties"
                    query='
                        SELECT "category=ENTITYCOUNT:::name=NEWS_COUNT:::value=" || CAST(countNews AS CHAR) AS extended_object_properties
                              FROM tour
                              WHERE tour.t_id IN (${route.t_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=TRIP_COUNT:::value=" || CAST(countTrips AS CHAR) AS extended_object_properties
                              FROM tour
                              WHERE tour.t_id IN (${route.t_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=INFO_COUNT:::value=" || CAST(countInfos AS CHAR) AS extended_object_properties
                              FROM tour
                              WHERE tour.t_id IN (${route.t_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=TRACK_COUNT:::value=" || CAST(countTracks AS CHAR) AS extended_object_properties
                              FROM tour
                              WHERE tour.t_id IN (${route.t_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_COUNT:::value=" || CAST(countImages AS CHAR) AS extended_object_properties
                              FROM tour
                              WHERE tour.t_id IN (${route.t_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_TOP_COUNT:::value=" || CAST(countImagesTop AS CHAR) AS extended_object_properties
                              FROM tour
                              WHERE tour.t_id IN (${route.t_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=VIDEO_COUNT:::value=" || CAST(countVideos AS CHAR) AS extended_object_properties
                              FROM tour
                              WHERE tour.t_id IN (${route.t_id})
                    '>
                <field column="extended_object_properties" name="extended_object_properties_txt"/>
            </entity>

            <entity name="route_linkedplaylists"
                    query='
                        SELECT playlist.p_id, playlist.p_name, tour_playlist.tp_pos,
                           "type=playlist:::name=" || COALESCE(p_name, "null") || ":::refId=", CAST(playlist.p_id AS CHAR) ||
                           ":::position=" || COALESCE(tour_playlist.tp_pos, "null")
                          AS linkedplaylists
                          FROM playlist INNER JOIN tour_playlist ON playlist.p_id = tour_playlist.p_id WHERE tour_playlist.t_id IN (${route.t_id})
                          ORDER BY p_name'>
                <field column="p_id" name="playlist_id_is"/>
                <field column="p_name" name="playlists_txt"/>
                <field column="tp_pos" name="position_is"/>
                <field column="linkedplaylists" name="linkedplaylists_txt"/>
            </entity>

            <entity name="route_linkedroutes"
                    query='
                    SELECT * FROM (
                    SELECT k_route_attr AS kt_route_attr
                      FROM tour INNER JOIN kategorie_full ON kategorie_full.t_id = tour.t_id WHERE tour.t_id IN (${route.t_id})
                    UNION
                    SELECT kt_route_attr
                      FROM tour INNER JOIN kategorie_tour ON kategorie_tour.t_id = tour.t_id WHERE tour.t_id IN (${route.t_id})
                    )  routessrc GROUP BY kt_route_attr ORDER BY kt_route_attr'>
                <field column="kt_route_attr" name="linked_route_attr_s"/>
                <field column="kt_route_attr" name="route_attr_ss"/>
                <field column="kt_route_attr" name="route_attr_txt"/>
            </entity>

            <entity name="route_image"
                    query="
                        SELECT
                             image.i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url, i_persons, i_objects
                        FROM image INNER JOIN kategorie_full ON image.k_id=kategorie_full.k_id
                        WHERE
                            kategorie_full.t_id = ${route.t_id}
                            AND COALESCE(I_PERSONS, '') = ''
                        ORDER BY I_RATE_MOTIVE DESC, I_RATE_WICHTIGKEIT DESC, I_RATE DESC, image.I_ID DESC
                        limit 10"
                    deltaImportQuery="
                        SELECT i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url, i_persons, i_objects
                        FROM image WHERE i_id='${dih.delta.id}'"
                    deltaQuery="SELECT i_id FROM image'"
            >
                <field column="i_id" name="i_fav_id_is" />
                <field column="i_date" name="i_fav_i_date_dts" />
                <field column="i_url" name="i_fav_url_txt" />
                <field column="i_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="i_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            </entity>
            <entity name="route_track"
                    query="
                        SELECT kategorie_full.k_id,
                               tr_id,
                               n_id,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               k_persons,
                               k_objects,
                               k_route_attr
                        FROM kategorie_full
                            INNER JOIN kategorie_tour ON kategorie_full.k_id = kategorie_tour.k_id
                        WHERE kategorie_tour.t_id = ${route.t_id}
                        ORDER BY k_datevon asc"
                    deltaImportQuery="
                        SELECT tr_id,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               k_persons,
                               k_objects,
                               k_route_attr
                        FROM kategorie_full
                        WHERE k_id = '${dih.delta.id}'"
                    deltaQuery="SELECT k_id FROM kategorie_full'"
            >
                <field column="k_id" name="track_id_is"/>
                <field column="tr_id" name="trip_id_is"/>
                <field column="n_id" name="news_id_is"/>
                <field column="k_datevon" name="date_dts" />
                <field column="week" name="week_is" />
                <field column="month" name="month_is" />
                <field column="year" name="year_is" />
                <field column="k_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_route_attr" name="route_attr_ss"/>
                <field column="k_route_attr" name="route_attr_txt"/>
            </entity>
            <entity name="route_destination"
                    query="select d_id FROM destination WHERE d_id = '${route.d_id}'"
                    deltaImportQuery="select d_id FROM destination WHERE d_id='${dih.delta.id}'"
                    deltaQuery="SELECT d_id FROM destination'"
            >
                <field column="d_id" name="destination_id_ss"/>
            </entity>
            <entity name="route_poi"
                    query="
                        SELECT poi.poi_id
                          FROM poi
                          INNER JOIN tour_poi ON tour_poi.poi_id = poi.poi_id
                          INNER JOIN tour ON tour_poi.t_id = tour.t_id
                          WHERE tour.t_id IN (${route.t_id})"
                    deltaImportQuery="select poi_id FROM poi WHERE poi_id='${dih.delta.id}'"
                    deltaQuery="SELECT poi_id FROM poi'"
            >
                <field column="poi_id" name="poi_id_is"/>
            </entity>

            <entity name="route_linkedinfos"
                    query='
                    SELECT "type=" || COALESCE(if_typ, "null") || ":::name=" || COALESCE(if_name, "null") ||
                        ":::refId=" || CAST(info.if_id AS CHAR) || ":::linkedDetails=" || COALESCE(tour_info.tif_linked_details, "null")
                        AS linkedinfos, info.if_id
                    FROM info INNER JOIN tour_info ON tour_info.if_id = info.if_id WHERE tour_info.t_id IN (${route.t_id})
                        ORDER BY if_name'>
                <field column="if_id" name="info_id_is"/>
                <field column="linkedinfos" name="linkedinfos_txt"/>
            </entity>

        </entity>

        <entity name="location"
                pk="id"
                query="
                    SELECT 'LOCATION'                                                                                     AS type,
                           location.l_calced_subtype                          AS subtype,
                           l_calced_id                          AS id,
                           l_id,
                           l_parent_id,
                           location.countImages,
                           location.countImagesTop,
                           location.countInfos,
                           location.countNews,
                           location.countRoutes,
                           location.countTracks,
                           location.countTrips,
                           location.countVideos,
                           l_name,
                           l_html,
                           l_meta_shortdesc_md,
                           l_meta_shortdesc_html,
                           l_meta_shortdesc_html                                                                          AS l_meta_shortdesc_html2,
                           l_html || ' ' || l_name || ' ' || l_keywords || ' ' || l_meta_shortdesc_md || ' ' || l_lochirarchietxt AS html,
                           l_gps_lat,
                           l_gps_lon,
                           l_calced_gps_loc                                                              AS l_gps_loc,
                           l_geo_state,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           l_katids,
                           l_tids,
                           l_dids,
                           l_keywords,
                           l_persons,
                           l_objects
                    FROM location
                    ORDER BY l_typ asc, l_name"
                deltaImportQuery="
                    SELECT 'LOCATION'                                                                                     AS type,
                           l_calced_id                          AS id,
                           l_id,
                           location.countImages,
                           location.countImagesTop,
                           location.countInfos,
                           location.countNews,
                           location.countRoutes,
                           location.countTracks,
                           location.countTrips,
                           location.countVideos,
                           l_name,
                           l_html,
                           l_meta_shortdesc_md,
                           l_meta_shortdesc_html,
                           l_meta_shortdesc_html                                                                          AS l_meta_shortdesc_html2,
                           l_html || ' ' || l_name || ' ' || l_keywords || ' ' || l_meta_shortdesc_md || ' ' || l_lochirarchietxt AS html,
                           l_gps_lat,
                           l_gps_lon,
                           l_calced_gps_loc                                                              AS l_gps_loc,
                           l_geo_state,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           l_katids,
                           l_tids,
                           l_dids,
                           l_keywords,
                           l_persons,
                           l_objects
                    FROM location
                    WHERE l_id = '${dih.delta.id}'"
                deltaQuery="SELECT l_id FROM location ORDER BY l_typ asc, l_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="l_id" name="loc_id_i"/>
            <field column="l_id" name="loc_id_is"/>
            <field column="l_parent_id" name="loc_parent_id_i"/>

            <field column="l_name" name="name_s" stripHTML="true" />
            <field column="l_name" name="name_txt" stripHTML="true" />
            <field column="html" name="html_txt" stripHTML="true" />
            <field column="l_meta_shortdesc_html" name="desc_txt" stripHTML="true" />
            <field column="l_meta_shortdesc_md" name="desc_md_txt" stripHTML="false" />
            <field column="l_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="l_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
            <field column="l_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            <field column="l_gps_lat" name="geo_lat_s" />
            <field column="l_gps_lon" name="geo_lon_s" />
            <field column="l_gps_loc" name="geo_loc_p" type="location" />
            <field column="l_geo_state" name="gpstracks_state_i" />
            <field column="l_geo_state" name="gpstracks_state_is" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="subtype" name="subtype_s" />
            <field column="subtype" name="subtype_ss" />
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="countImages" name="count_images_i" />
            <field column="countImagesTop" name="count_images_top_i" />
            <field column="countInfos" name="count_infos_i" />
            <field column="countNews" name="count_news_i" />
            <field column="countRoutes" name="count_routes_i" />
            <field column="countTracks" name="count_tracks_i" />
            <field column="countTrips" name="count_trips_i" />
            <field column="countVideos" name="count_videos_i" />

            <!-- child='true' -->
            <entity name="location_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=LOCATION_" || l_id || ":::name=" || COALESCE(l_name, "null") || ":::navtype=PREDECESSOR") AS navigation_objects,
                                l_lochirarchietxt
                            FROM location
                            WHERE l_lochirarchietxt &lt; (SELECT l_lochirarchietxt FROM location WHERE l_id IN (${location.l_id}))
                            ORDER BY l_lochirarchietxt DESC, l_id DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=LOCATION_" || l_id || ":::name=" || COALESCE(l_name, "null") || ":::navtype=SUCCESSOR") AS navigation_objects, l_lochirarchietxt
                            FROM location
                            WHERE l_lochirarchietxt &gt; (SELECT l_lochirarchietxt FROM location WHERE l_id IN (${location.l_id}))
                            ORDER BY l_lochirarchietxt, l_id LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="location_extended_object_properties"
                    query='
                        SELECT "category=ENTITYCOUNT:::name=NEWS_COUNT:::value=" || CAST(countNews AS CHAR) AS extended_object_properties
                              FROM location
                              WHERE location.l_id IN (${location.l_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=ROUTE_COUNT:::value=" || CAST(countRoutes AS CHAR) AS extended_object_properties
                              FROM location
                              WHERE location.l_id IN (${location.l_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=INFO_COUNT:::value=" || CAST(countInfos AS CHAR) AS extended_object_properties
                              FROM location
                              WHERE location.l_id IN (${location.l_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=TRIP_COUNT:::value=" || CAST(countTrips AS CHAR) AS extended_object_properties
                              FROM location
                              WHERE location.l_id IN (${location.l_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=TRACK_COUNT:::value=" || CAST(countTracks AS CHAR) AS extended_object_properties
                              FROM location
                              WHERE location.l_id IN (${location.l_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_COUNT:::value=" || CAST(countImages AS CHAR) AS extended_object_properties
                              FROM location
                              WHERE location.l_id IN (${location.l_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_TOP_COUNT:::value=" || CAST(countImagesTop AS CHAR) AS extended_object_properties
                              FROM location
                              WHERE location.l_id IN (${location.l_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=VIDEO_COUNT:::value=" || CAST(countVideos AS CHAR) AS extended_object_properties
                              FROM location
                              WHERE location.l_id IN (${location.l_id})
                    '>
                <field column="extended_object_properties" name="extended_object_properties_txt"/>
            </entity>

            <entity name="location_image"
                    query="
                        SELECT i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url, i_persons, i_objects
                        FROM image
                        WHERE k_id in (${location.l_katids} 0)
                            AND COALESCE(I_PERSONS, '') = ''
                        ORDER BY I_RATE_MOTIVE DESC, I_RATE_WICHTIGKEIT DESC, I_RATE DESC, I_ID DESC
                        limit 10"
                    deltaImportQuery="
                        SELECT i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url, i_persons, i_objects
                        FROM image WHERE i_id='${dih.delta.id}'"
                    deltaQuery="SELECT i_id FROM image'"
            >
                <field column="i_id" name="i_fav_id_is" />
                <field column="i_date" name="i_fav_i_date_dts" />
                <field column="i_url" name="i_fav_url_txt" />
                <field column="i_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="i_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            </entity>

            <entity name="location_tour"
                    query="select t_id, t_keywords, tour.t_calced_actiontype AS actiontype FROM tour WHERE t_id in (${location.l_tids} 0)"
                    deltaImportQuery="select t_id, t_keywords FROM tour WHERE t_id='${dih.delta.id}'"
                    deltaQuery="SELECT t_id FROM tour'"
            >
                <field column="t_id" name="route_id_is"/>
                <field column="t_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
                <field column="actiontype" name="actiontype_ss" />
            </entity>
            <entity name="location_track"
                    query="
                        SELECT k_id,
                               tr_id,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               k_persons,
                               k_objects
                        FROM kategorie_full
                        WHERE k_id in (${location.l_katids} 0)
                        ORDER BY k_datevon asc"
                    deltaImportQuery="
                        SELECT k_id,
                               tr_id,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               k_persons,
                               k_objects
                        FROM kategorie_full
                        WHERE k_id = {'dih.delta.id}'"
                    deltaQuery="SELECT k_id FROM kategorie_full'">
                <field column="k_id" name="track_id_is"/>
                <field column="tr_id" name="trip_id_is"/>
                <field column="k_datevon" name="date_dts" />
                <field column="week" name="week_is" />
                <field column="month" name="month_is" />
                <field column="year" name="year_is" />
                <field column="k_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            </entity>

            <entity name="location_linkedplaylists"
                    query='
                        SELECT playlist.p_id, playlist.p_name, location_playlist.lp_pos,
                           "type=playlist:::name=" || COALESCE(p_name, "null") || ":::refId=", CAST(playlist.p_id AS CHAR) ||
                           ":::position=" || COALESCE(location_playlist.lp_pos, "null")
                          AS linkedplaylists
                          FROM playlist INNER JOIN location_playlist ON playlist.p_id = location_playlist.p_id WHERE location_playlist.l_id IN (${location.l_id})
                          ORDER BY p_name'>
                <field column="p_id" name="playlist_id_i"/>
                <field column="p_id" name="playlist_id_is"/>
                <field column="p_name" name="playlists_txt"/>
                <field column="lp_pos" name="position_is"/>
                <field column="linkedplaylists" name="linkedplaylists_txt"/>
            </entity>

            <entity name="location_linkedinfos"
                    query='
                    SELECT "type=" || COALESCE(if_typ, "null") || ":::name=" || COALESCE(if_name, "null") ||
                        ":::refId=" || CAST(info.if_id AS CHAR) || ":::linkedDetails=" || COALESCE(location_info.lif_linked_details, "null")
                        AS linkedinfos, info.if_id
                    FROM location
                          INNER JOIN location_info ON location_info.l_id = location.l_id
                          INNER JOIN info ON location_info.if_id = info.if_id
                          WHERE location.l_id IN (${location.l_id}) GROUP BY info.if_id
                        ORDER BY if_name'>
                <field column="if_id" name="info_id_is"/>
                <field column="linkedinfos" name="linkedinfos_txt"/>
            </entity>

            <entity name="location_info"
                    query="
                        SELECT info.if_id, GROUP_CONCAT(COALESCE(lif_linked_details, ''), ', ') AS lif_ref_details
                          FROM location
                          INNER JOIN location_info ON location_info.l_id = location.l_id
                          INNER JOIN info ON location_info.if_id = info.if_id
                          WHERE location.l_id IN (${location.l_id}) GROUP BY info.if_id"
                    deltaImportQuery="select info.if_id FROM info WHERE if_id='${dih.delta.id}'"
                    deltaQuery="SELECT if_id FROM info'"
            >
                <field column="if_id" name="info_id_is"/>
                <field column="lif_ref_details" name="info_lif_linked_details_s"/>
            </entity>

            <entity name="location_info2"
                    query="
                        SELECT info.if_id
                          FROM info
                          WHERE l_id IN (${location.l_id}) GROUP BY info.if_id"
                    deltaImportQuery="select info.if_id FROM info WHERE if_id='${dih.delta.id}'"
                    deltaQuery="SELECT if_id FROM info'"
            >
                <field column="if_id" name="info_id_is"/>
            </entity>
        </entity>

        <entity name="poi"
                pk="id"
                query="
                    SELECT DISTINCT poi.poi_id,
                                    'POI'                                           AS type,
                                    poi.poi_calced_id                          AS id,
                                    poi.countRoutes,
                                    poi.countTracks,
                                    poi_name,
                                    poi_meta_desc,
                                    poi_reference,
                                    poi_calced_gps_lat,
                                    poi_calced_gps_lon,
                                    poi_calced_gps_loc,
                                    poi_calced_altMaxFacet,
                                    poi_name || ' ' || poi_keywords || ' ' || poi_reference || ' ' || poi_meta_desc AS html,
                                    poi_keywords
                    FROM POI
                    ORDER BY poi_name"
                deltaImportQuery="
                    SELECT DISTINCT poi.poi_id,
                                    'poi'                                           AS type,
                                    poi.poi_calced_id                          AS id,
                                    poi.countRoutes,
                                    poi.countTracks,
                                    poi_name,
                                    poi_meta_desc,
                                    poi_reference,
                                    poi_calced_gps_lat,
                                    poi_calced_gps_lon,
                                    poi_calced_gps_loc,
                                    poi_calced_altMaxFacet,
                                    poi_name || ' ' || poi_keywords || ' ' || poi_reference || ' ' || poi_meta_desc AS html,
                                    poi_keywords
                    FROM POI
                    WHERE poi.poi_id = '${dih.delta.id}'"
                deltaQuery="SELECT poi_id FROM poi ORDER BY poi_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="poi_id" name="poi_id_i"/>
            <field column="poi_id" name="poi_id_is"/>

            <field column="poi_name" name="name_s" stripHTML="true" />
            <field column="poi_name" name="name_txt" stripHTML="true" />
            <field column="poi_reference" name="poi_reference_s" stripHTML="true" />
            <field column="poi_meta_desc" name="desc_txt" stripHTML="true" />
            <field column="poi_meta_desc" name="desc_md_txt" stripHTML="false" />
            <field column="poi_calced_gps_lat" name="geo_lat_s" />
            <field column="poi_calced_gps_lon" name="geo_lon_s" />
            <field column="poi_calced_gps_loc" name="geo_loc_p" type="location" />
            <field column="poi_calced_altMaxFacet" name="data_tech_alt_max_facet_is" />
            <field column="html" name="html_txt" />
            <field column="poi_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="countRoutes" name="count_routes_i" />
            <field column="countTracks" name="count_tracks_i" />

            <!-- child='true' -->
            <entity name="poi_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=POI_" || poi_id || ":::name=" || COALESCE(poi_name, "null") || ":::navtype=PREDECESSOR") AS navigation_objects
                            FROM poi
                            WHERE poi_name &lt; (SELECT poi_name FROM poi WHERE poi_id IN (${poi.poi_id}))
                            ORDER BY poi_name DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=POI_" || poi_id || ":::name=" || COALESCE(poi_name, "null") || ":::navtype=SUCCESSOR") AS navigation_objects
                            FROM poi
                            WHERE poi_name &gt; (SELECT poi_name FROM poi WHERE poi_id IN (${poi.poi_id}))
                            ORDER BY poi_name LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="poi_extended_object_properties"
                    query='
                         SELECT "category=ENTITYCOUNT:::name=ROUTE_COUNT:::value=" || CAST(countRoutes AS CHAR) AS extended_object_properties
                              FROM poi
                              WHERE poi.poi_id IN (${poi.poi_id})
                           UNION
                         SELECT "category=ENTITYCOUNT:::name=TRACK_COUNT:::value=" || CAST(countTracks AS CHAR) AS extended_object_properties
                              FROM poi
                              WHERE poi.poi_id IN (${poi.poi_id})
                    '>
                <field column="extended_object_properties" name="extended_object_properties_txt"/>
            </entity>

            <entity name="poi_tour"
                    query="
                        SELECT tour.t_id, tour.d_id, t_keywords, tour.t_calced_actiontype AS actiontype
                          FROM poi
                          INNER JOIN tour_poi ON tour_poi.poi_id = poi.poi_id
                          INNER JOIN tour ON tour_poi.t_id = tour.t_id
                          WHERE poi.poi_id IN (${poi.poi_id})"
                    deltaImportQuery="select t_id, t_keywords FROM tour WHERE t_id='${dih.delta.id}'"
                    deltaQuery="SELECT t_id FROM tour'"
            >
                <field column="t_id" name="route_id_is"/>
                <field column="d_id" name="destination_id_ss" />
                <field column="actiontype" name="actiontype_ss" />
            </entity>
            <entity name="poi_destination"
                    query="
                        SELECT DISTINCT tour.d_id
                          FROM poi
                          INNER JOIN tour_poi ON tour_poi.poi_id = poi.poi_id
                          INNER JOIN tour ON tour_poi.t_id = tour.t_id
                          WHERE poi.poi_id IN (${poi.poi_id})"
                    deltaImportQuery="select d_id, t_keywords FROM tour WHERE t_id='${dih.delta.id}'"
                    deltaQuery="SELECT t_id FROM tour'"
            >
                <field column="d_id" name="destination_id_ss"/>
            </entity>
            <entity name="poi_track"
                    query="
                        SELECT kategorie_full.k_id,
                               tr_id,
                               n_id,
                               kategorie_full.k_calced_actiontype AS actiontype,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               k_persons,
                               k_objects
                        FROM poi
                            INNER JOIN kategorie_poi ON kategorie_poi.poi_id = poi.poi_id
                            INNER JOIN kategorie_full ON kategorie_poi.k_id = kategorie_full.k_id
                        WHERE poi.poi_id IN (${poi.poi_id})
                        ORDER BY k_datevon asc"
                    deltaImportQuery="
                        SELECT k_id,
                               tr_id,
                               n_id,
                               kategorie_full.k_calced_actiontype AS actiontype,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               k_persons,
                               k_objects
                        FROM kategorie_full
                        WHERE k_id = {'dih.delta.id}'"
                    deltaQuery="SELECT k_id FROM kategorie_full'">
                <field column="k_id" name="track_id_is"/>
                <field column="tr_id" name="trip_id_is"/>
                <field column="n_id" name="news_id_is"/>
                <field column="k_datevon" name="date_dts" />
                <field column="week" name="week_is" />
                <field column="month" name="month_is" />
                <field column="year" name="year_is" />
                <field column="actiontype" name="actiontype_ss" />
                <field column="k_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            </entity>
            <entity name="poi_destination"
                    query="
                        SELECT destination.d_id, d_keywords, destination.d_calced_actiontype AS actiontype
                          FROM poi
                          INNER JOIN tour_poi ON tour_poi.poi_id = poi.poi_id
                          INNER JOIN tour ON tour_poi.t_id = tour.t_id
                          INNER JOIN destination ON destination.d_id=tour.d_id
                          WHERE poi.poi_id IN (${poi.poi_id})"
                    deltaImportQuery="select d_id, d_keywords FROM destination WHERE d_id='${dih.delta.id}'"
                    deltaQuery="SELECT d_id FROM destination"
            >
                <field column="destination.d_id" name="destination_id_ss" />
                <field column="actiontype" name="actiontype_ss" />
            </entity>
        </entity>

        <entity name="image"
                pk="id"
                query="
                    SELECT 'IMAGE'                                                                                           AS type,
                           kategorie_full.k_calced_actiontype                          AS actiontype,
                           kategorie_full.k_calced_actiontype                          AS subtype,
                           image.i_calced_id                          AS id,
                           i_calced_path                                                                        AS i_url,
                           image.i_id,
                           image.k_id,
                           kategorie_full.tr_id,
                           kategorie_full.n_id,
                           kategorie_full.d_id,
                           image.t_id,
                           kategorie_full.l_id,
                           k_name,
                           i_katname,
                           i_katdesc,
                           i_katdesc || ' ' || k_name || ' ' || i_keywords || ' ' || k_meta_shortdesc_md || ' ' || l_lochirarchietxt AS html,
                           i_calced_week                                                                                      AS week,
                           i_calced_month                                                                                     AS month,
                           i_calced_year                                                                                      AS year,
                           i_dateshow || 'Z' AS i_dateshow,
                           i_date || 'Z'                                                                                            AS datesort,
                           i_date || 'Z' AS i_date,
                           i_calced_dateonly                                                      AS dateonly,
                           'DONE' || (i_date IS NOT NULL)                                                              AS done,
                           k_gpstracks_basefile,
                           k_gpstracks_state,
                           i_keywords,
                           i_persons,
                           i_objects,
                           i_objectdetections,
                           k_meta_shortdesc_md,
                           k_meta_shortdesc_html,
                           k_meta_shortdesc_html                                                                             AS k_meta_shortdesc_html2,
                           i_rate,
                           i_gps_lat,
                           i_gps_lon,
                           i_calced_gps_loc                                                                 AS i_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           `I_GPS_ELE`                                                                                       AS altMax,
                           `I_RATE`                                                                                          AS gesamt,
                           `I_RATE_MOTIVE`                                                                                   AS motive,
                           `I_RATE_WICHTIGKEIT`                                                                              AS wichtigkeit,
                           I_calced_altMaxFacet                                                               AS altMaxFacet
                    FROM image,
                         kategorie_full,
                         location
                    WHERE kategorie_full.l_id = location.l_id
                      AND image.k_id = kategorie_full.k_id
                    ORDER BY i_date, image.i_id"
                deltaImportQuery="
                    SELECT 'IMAGE'                                                  AS type,
                           kategorie_full.k_calced_actiontype                          AS actiontype,
                           kategorie_full.k_calced_actiontype                          AS subtype,
                           image.i_calced_id                          AS id,
                           i_calced_path                               AS i_url,
                           image.i_id,
                           image.k_id,
                           kategorie_full.n_id,
                           kategorie_full.d_id,
                           image.t_id,
                           kategorie_full.l_id,
                           k_name,
                           i_katname,
                           i_katdesc,
                           i_katdesc || ' ' || k_name || ' ' || k_meta_shortdesc_md AS html,
                           i_calced_week                                             AS week,
                           i_calced_month                                            AS month,
                           i_calced_year                                             AS year,
                           i_dateshow || 'Z' AS i_dateshow,
                           i_date || 'Z'                                                   AS datesort,
                           i_date || 'Z' AS i_date,
                           i_calced_dateonly             AS dateonly,
                           'DONE' || (i_date IS NOT NULL)                     AS done,
                           k_gpstracks_basefile,
                           k_gpstracks_state,
                           i_keywords,
                           i_persons,
                           i_objects,
                           i_objectdetections,
                           k_meta_shortdesc_md,
                           k_meta_shortdesc_html,
                           k_meta_shortdesc_html                                    AS k_meta_shortdesc_html2,
                           i_rate,
                           i_gps_lat,
                           i_gps_lon,
                           i_calced_gps_loc                        AS i_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           `I_GPS_ELE`                                              AS altMax,
                           `I_RATE`                                                 AS gesamt,
                           `I_RATE_MOTIVE`                                          AS motive,
                           `I_RATE_WICHTIGKEIT`                                     AS wichtigkeit,
                           I_calced_altMaxFacet                                                               AS altMaxFacet
                    FROM image,
                         kategorie_full,
                         location
                    WHERE kategorie_full.l_id = location.l_id
                      AND image.k_id = kategorie_full.k_id
                      AND image.i_id = '${dih.delta.id}'"
                deltaQuery="SELECT i_id FROM image ORDER BY i_date, i_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="i_id" name="image_id_i"/>
            <field column="i_id" name="image_id_is"/>
            <field column="k_id" name="track_id_i"/>
            <field column="k_id" name="track_id_is"/>
            <field column="t_id" name="route_id_i"/>
            <field column="t_id" name="route_id_is"/>
            <field column="d_id" name="destination_id_s"/>
            <field column="d_id" name="destination_id_ss"/>
            <field column="tr_id" name="trip_id_i"/>
            <field column="tr_id" name="trip_id_is"/>
            <field column="l_id" name="loc_id_i"/>
            <field column="l_id" name="loc_id_is"/>
            <field column="n_id" name="news_id_i"/>
            <field column="n_id" name="news_id_is"/>

            <field column="k_name" name="name_s" stripHTML="true" />
            <field column="k_name" name="name_txt" stripHTML="true" />
            <field column="html" name="html_txt" stripHTML="true" />
            <field column="k_meta_shortdesc_html" name="desc_txt" stripHTML="true" />
            <field column="k_meta_shortdesc_md" name="desc_md_txt" stripHTML="false" />
            <field column="i_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="i_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
            <field column="i_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            <field column="i_objectdetections" name="i_objectdetections_txt" regex="SEPARATOR" replaceWith=";;"/>
            <field column="k_gpstracks_basefile" name="gpstracks_basefile_s" />
            <field column="k_gpstracks_state" name="gpstracks_state_i" />
            <field column="k_gpstracks_state" name="gpstracks_state_is" />
            <field column="i_gps_lat" name="geo_lat_s" />
            <field column="i_gps_lon" name="geo_lon_s" />
            <field column="i_gps_loc" name="geo_loc_p" type="location" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="actiontype" name="actiontype_s" />
            <field column="actiontype" name="actiontype_ss" />
            <field column="subtype" name="subtype_s" />
            <field column="subtype" name="subtype_ss" />
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="dateonly" name="dateonly_s" />
            <field column="i_dateshow" name="dateshow_dt" />
            <field column="datesort" name="datesort_dt" />
            <field column="done" name="done_ss" />
            <field column="i_date" name="date_dt" />
            <field column="i_date" name="date_dts" />
            <field column="week" name="week_is" />
            <field column="month" name="month_is" />
            <field column="year" name="year_is" />
            <field column="i_id" name="i_fav_id_is" />
            <field column="i_date" name="i_fav_i_date_dts" />
            <field column="i_url" name="i_fav_url_txt" />
            <field column="altMax" name="data_tech_alt_max_i" />
            <field column="altMaxFacet" name="data_tech_alt_max_facet_is" />
            <field column="gesamt" name="rate_pers_gesamt_i" />
            <field column="motive" name="rate_pers_motive_i" />
            <field column="wichtigkeit" name="rate_pers_wichtigkeit_i" />
            <field column="gesamt" name="rate_pers_gesamt_is" />

            <entity name="image_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=IMAGE_" || i_id || ":::name=" || COALESCE(i_katname, "null") || ":::navtype=PREDECESSOR") AS navigation_objects
                            FROM image
                            WHERE i_date &lt; (SELECT i_date FROM image WHERE i_id IN (${image.i_id}))
                            ORDER BY i_date DESC, i_id DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=IMAGE_" || i_id || ":::name=" || COALESCE(i_katname, "null") || ":::navtype=SUCCESSOR") AS navigation_objects
                             FROM image
                             WHERE i_date &gt; (SELECT i_date FROM image WHERE i_id IN (${image.i_id}))
                             ORDER BY i_date, i_id LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>


            <entity name="image_linkedplaylists"
                    query='
                        SELECT playlist.p_id, playlist.p_name, image_playlist.ip_pos,
                           "type=playlist:::name=" || COALESCE(p_name, "null") || ":::refId=" || CAST(playlist.p_id AS CHAR) ||
                           ":::position=" || COALESCE(image_playlist.ip_pos, "null")
                          AS linkedplaylists
                          FROM playlist INNER JOIN image_playlist ON playlist.p_id = image_playlist.p_id WHERE image_playlist.i_id IN (${image.i_id})
                          ORDER BY p_name'>
                <field column="p_id" name="playlist_id_is"/>
                <field column="p_name" name="playlists_txt"/>
                <field column="ip_pos" name="position_is"/>
                <field column="linkedplaylists" name="linkedplaylists_txt"/>
            </entity>
        </entity>

        <entity name="video"
                pk="id"
                query="
                    SELECT 'VIDEO'                                                                                           AS type,
                           kategorie_full.k_calced_actiontype                          AS actiontype,
                           kategorie_full.k_calced_actiontype                          AS subtype,
                           video.v_calced_id                          AS id,
                           v_calced_path                                                                        AS v_url,
                           video.v_id,
                           video.k_id,
                           kategorie_full.tr_id,
                           kategorie_full.d_id,
                           kategorie_full.n_id,
                           video.t_id,
                           kategorie_full.l_id,
                           k_name,
                           v_katname,
                           v_katdesc,
                           v_katdesc || ' ' || k_name || ' ' || v_keywords || ' ' || k_meta_shortdesc_md || ' ' || l_lochirarchietxt AS html,
                           v_calced_week                                                                                      AS week,
                           v_calced_month                                                                                     AS month,
                           v_calced_year                                                                                      AS year,
                           v_dateshow || 'Z' AS v_dateshow,
                           v_date || 'Z'                                                                                            AS datesort,
                           v_date || 'Z' AS v_date,
                           v_calced_dateonly                                                      AS dateonly,
                           'DONE' || (v_date IS NOT NULL)                                                              AS done,
                           k_gpstracks_basefile,
                           k_gpstracks_state,
                           v_keywords,
                           v_persons,
                           v_objects,
                           k_meta_shortdesc_md,
                           k_meta_shortdesc_html,
                           k_meta_shortdesc_html                                                                             AS k_meta_shortdesc_html2,
                           v_rate,
                           v_gps_lat,
                           v_gps_lon,
                           v_calced_gps_loc                                                                 AS v_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           `V_GPS_ELE`                                                                                       AS altMax,
                           `V_RATE`                                                                                          AS gesamt,
                           `V_RATE_MOTIVE`                                                                                   AS motive,
                           `V_RATE_WICHTIGKEIT`                                                                              AS wichtigkeit,
                           V_calced_altMaxFacet                                                               AS altMaxFacet
                    FROM video,
                         kategorie_full,
                         location
                    WHERE kategorie_full.l_id = location.l_id
                      AND video.k_id = kategorie_full.k_id
                    ORDER BY v_date, video.v_id"
                deltaImportQuery="
                    SELECT 'VIDEO'                                                  AS type,
                           kategorie_full.k_calced_actiontype                          AS actiontype,
                           kategorie_full.k_calced_actiontype                          AS subtype,
                           video.v_calced_id                          AS id,
                           v_calced_path                               AS v_url,
                           video.v_id,
                           video.k_id,
                           kategorie_full.d_id,
                           kategorie_full.n_id,
                           video.t_id,
                           kategorie_full.l_id,
                           k_name,
                           v_katname,
                           v_katdesc,
                           v_katdesc || ' ' || k_name || ' ' || k_meta_shortdesc_md AS html,
                           v_calced_week                                             AS week,
                           v_calced_month                                            AS month,
                           v_calced_year                                             AS year,
                           v_dateshow || 'Z' AS v_dateshow,
                           v_date || 'Z'                                                   AS datesort,
                           v_date || 'Z' AS v_date,
                           v_calced_dateonly             AS dateonly,
                           'DONE' || (v_date IS NOT NULL)                     AS done,
                           k_gpstracks_basefile,
                           k_gpstracks_state,
                           v_keywords,
                           v_persons,
                           v_objects,
                           k_meta_shortdesc_md,
                           k_meta_shortdesc_html,
                           k_meta_shortdesc_html                                    AS k_meta_shortdesc_html2,
                           v_rate,
                           v_gps_lat,
                           v_gps_lon,
                           v_calced_gps_loc                        AS v_gps_loc,
                           l_lochirarchietxt,
                           l_lochirarchieids,
                           `V_GPS_ELE`                                              AS altMax,
                           `V_RATE`                                                 AS gesamt,
                           `V_RATE_MOTIVE`                                          AS motive,
                           `V_RATE_WICHTIGKEIT`                                     AS wichtigkeit,
                           V_calced_altMaxFacet                                                               AS altMaxFacet
                    FROM video,
                         kategorie_full,
                         location
                    WHERE kategorie_full.l_id = location.l_id
                      AND video.k_id = kategorie_full.k_id
                      AND video.v_id = '${dih.delta.id}'"
                deltaQuery="SELECT v_id FROM video ORDER BY v_date, v_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="v_id" name="video_id_i"/>
            <field column="v_id" name="video_id_is"/>
            <field column="k_id" name="track_id_i"/>
            <field column="k_id" name="track_id_is"/>
            <field column="d_id" name="destination_id_s"/>
            <field column="d_id" name="destination_id_ss"/>
            <field column="t_id" name="route_id_i"/>
            <field column="t_id" name="route_id_is"/>
            <field column="tr_id" name="trip_id_i"/>
            <field column="tr_id" name="trip_id_is"/>
            <field column="l_id" name="loc_id_i"/>
            <field column="l_id" name="loc_id_is"/>
            <field column="n_id" name="news_id_i"/>
            <field column="n_id" name="news_id_is"/>

            <field column="k_name" name="name_s" stripHTML="true" />
            <field column="k_name" name="name_txt" stripHTML="true" />
            <field column="html" name="html_txt" stripHTML="true" />
            <field column="k_meta_shortdesc_html" name="desc_txt" stripHTML="true" />
            <field column="k_meta_shortdesc_md" name="desc_md_txt" stripHTML="false" />
            <field column="v_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="v_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
            <field column="v_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            <field column="k_gpstracks_basefile" name="gpstracks_basefile_s" />
            <field column="k_gpstracks_state" name="gpstracks_state_i" />
            <field column="k_gpstracks_state" name="gpstracks_state_is" />
            <field column="v_gps_lat" name="geo_lat_s" />
            <field column="v_gps_lon" name="geo_lon_s" />
            <field column="v_gps_loc" name="geo_loc_p" type="location" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="actiontype" name="actiontype_s" />
            <field column="actiontype" name="actiontype_ss" />
            <field column="subtype" name="subtype_s" />
            <field column="subtype" name="subtype_ss" />
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="dateonly" name="dateonly_s" />
            <field column="v_dateshow" name="dateshow_dt" />
            <field column="datesort" name="datesort_dt" />
            <field column="done" name="done_ss" />
            <field column="v_date" name="date_dt" />
            <field column="v_date" name="date_dts" />
            <field column="week" name="week_is" />
            <field column="month" name="month_is" />
            <field column="year" name="year_is" />
            <field column="v_id" name="v_fav_id_is" />
            <field column="v_date" name="v_fav_v_date_dts" />
            <field column="v_url" name="v_fav_url_txt" />
            <field column="altMax" name="data_tech_alt_max_i" />
            <field column="altMaxFacet" name="data_tech_alt_max_facet_is" />
            <field column="gesamt" name="rate_pers_gesamt_i" />
            <field column="motive" name="rate_pers_motive_i" />
            <field column="wichtigkeit" name="rate_pers_wichtigkeit_i" />
            <field column="gesamt" name="rate_pers_gesamt_is" />

            <!-- child='true' -->
            <entity name="video_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=VIDEO_" || v_id || ":::name=" || COALESCE(v_katname, "null") || ":::navtype=PREDECESSOR") AS navigation_objects
                            FROM video
                            WHERE v_date &lt; (SELECT v_date FROM video WHERE v_id IN (${video.v_id}))
                            ORDER BY v_date DESC, v_id DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=VIDEO_" || v_id || ":::name=" || COALESCE(v_katname, "null") || ":::navtype=SUCCESSOR") AS navigation_objects
                             FROM video
                             WHERE v_date &gt; (SELECT v_date FROM video WHERE v_id IN (${video.v_id}))
                             ORDER BY v_date, v_id LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="video_linkedplaylists"
                    query='
                        SELECT playlist.p_id, playlist.p_name, video_playlist.vp_pos,
                           "type=playlist:::name=" || COALESCE(p_name, "null") || ":::refId=" || CAST(playlist.p_id AS CHAR) ||
                           ":::position=" || COALESCE(video_playlist.vp_pos, "null")
                          AS linkedplaylists
                          FROM playlist INNER JOIN video_playlist ON playlist.p_id = video_playlist.p_id WHERE video_playlist.v_id IN (${video.v_id})
                          ORDER BY p_name'>
                <field column="p_id" name="playlist_id_is"/>
                <field column="p_name" name="playlists_txt"/>
                <field column="vp_pos" name="position_is"/>
                <field column="linkedplaylists" name="linkedplaylists_txt"/>
            </entity>
        </entity>

        <entity name="trip"
                pk="id"
                query="
                    SELECT DISTINCT trip.tr_id,
                                    'TRIP'                                                       AS type,
                                    trip.tr_calced_id                          AS id,
                                    trip.l_id,
                                    trip.countImages,
                                    trip.countImagesTop,
                                    trip.countRoutes,
                                    trip.countTracks,
                                    trip.countVideos,
                                    tr_dateshow || 'Z' AS tr_dateshow,
                                    tr_datevon || 'Z'                                                   AS datesort,
                                    tr_datevon || 'Z' AS tr_datevon,
                                    tr_calced_dateonly             AS dateonly,
                                    'DONE' || (tr_datevon IS NOT NULL)                     AS done,
                                    (JULIANDAY(tr_datebis) - JULIANDAY(tr_datevon)) * 24         AS dur,
                                    tr_name,
                                    tr_meta_shortdesc_md,
                                    tr_meta_shortdesc_html,
                                    tr_meta_shortdesc_html                                       AS tr_meta_shortdesc_html2,
                                    tr_name || ' ' || tr_keywords || ' ' || tr_meta_shortdesc_md AS html,
                                    tr_keywords,
                                    tr_persons,
                                    tr_objects,
                                    l_lochirarchietxt,
                                    l_lochirarchieids,
                                    SUM(K_ALTITUDE_ASC)                                          AS altAsc,
                                    SUM(K_ALTITUDE_DESC)                                         AS altDesc,
                                    MAX(K_ALTITUDE_MAX)                                          AS altMax,
                                    MAX(ROUND((K_ALTITUDE_MAX / 500)) * 500)                     AS altMaxFacet,
                                    MIN(K_ALTITUDE_MIN)                                          AS altMin,
                                    MIN(ROUND((K_ALTITUDE_MIN / 500)) * 500)                     AS altMinFacet,
                                    SUM(K_DISTANCE)                                              AS dist
                    FROM trip
                             inner join kategorie_full ON trip.tr_id = kategorie_full.tr_id
                             LEFT JOIN location ON trip.l_id = location.l_id
                    GROUP BY trip.tr_id, type, id, tr_dateshow, datesort, tr_datevon, dateonly, dur, tr_name, tr_meta_shortdesc_md,
                             tr_meta_shortdesc_html, tr_meta_shortdesc_html2, html, tr_keywords, l_lochirarchietxt, l_lochirarchieids
                    ORDER BY tr_datevon"
                deltaImportQuery="
                    SELECT DISTINCT trip.tr_id,
                                    'TRIP'                                                       AS type,
                                    trip.tr_calced_id                          AS id,
                                    trip.l_id,
                                    trip.countImages,
                                    trip.countImagesTop,
                                    trip.countRoutes,
                                    trip.countTracks,
                                    trip.countVideos,
                                    tr_dateshow || 'Z' AS tr_dateshow,
                                    tr_datevon || 'Z'                                                   AS datesort,
                                    tr_datevon || 'Z' AS tr_datevon,
                                    tr_calced_dateonly             AS dateonly,
                                    'DONE' || (tr_datevon IS NOT NULL)                     AS done,
                                    (JULIANDAY(tr_datebis) - JULIANDAY(tr_datevon)) * 24         AS dur,
                                    tr_name,
                                    tr_meta_shortdesc_md,
                                    tr_meta_shortdesc_html,
                                    tr_meta_shortdesc_html                                       AS tr_meta_shortdesc_html2,
                                    tr_name || ' ' || tr_keywords || ' ' || tr_meta_shortdesc_md AS html,
                                    tr_keywords,
                                    tr_persons,
                                    tr_objects,
                                    l_lochirarchietxt,
                                    l_lochirarchieids,
                                    SUM(K_ALTITUDE_ASC)                                          AS altAsc,
                                    SUM(K_ALTITUDE_DESC)                                         AS altDesc,
                                    MAX(K_ALTITUDE_MAX)                                          AS altMax,
                                    MAX(ROUND((K_ALTITUDE_MAX / 500)) * 500)                     AS altMaxFacet,
                                    MIN(K_ALTITUDE_MIN)                                          AS altMin,
                                    MIN(ROUND((K_ALTITUDE_MIN / 500)) * 500)                     AS altMinFacet,
                                    SUM(K_DISTANCE)                                              AS dist
                    FROM trip
                             inner join kategorie_full ON trip.tr_id = kategorie_full.tr_id
                             LEFT JOIN location ON trip.l_id = location.l_id
                    WHERE trip.tr_id = '${dih.delta.id}'
                    GROUP BY trip.tr_id, type, id, tr_dateshow, datesort, tr_datevon, dateonly, dur, tr_name, tr_meta_shortdesc_md,
                             tr_meta_shortdesc_html, tr_meta_shortdesc_html2, html, tr_keywords, l_lochirarchietxt, l_lochirarchieids
                    ORDER BY tr_datevon"
                deltaQuery="SELECT tr_id FROM trip WHERE tr_id in (select tr_id FROM kategorie_full) ORDER BY tr_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="tr_id" name="trip_id_i"/>
            <field column="tr_id" name="trip_id_is"/>
            <field column="l_id" name="loc_id_i"/>
            <field column="l_id" name="loc_id_is"/>

            <field column="tr_name" name="name_s" stripHTML="true" />
            <field column="tr_name" name="name_txt" stripHTML="true" />
            <field column="tr_meta_shortdesc_html" name="desc_txt" stripHTML="true" />
            <field column="tr_meta_shortdesc_md" name="desc_md_txt" stripHTML="false" />
            <field column="html" name="html_txt" stripHTML="true" />
            <field column="tr_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="tr_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
            <field column="tr_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            <field column="tr_dateshow" name="dateshow_dt" />
            <field column="datesort" name="datesort_dt" />
            <field column="tr_datevon" name="date_dt" />
            <field column="dateonly" name="dateonly_s" />
            <field column="done" name="done_ss" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="altAsc" name="data_tech_alt_asc_i" />
            <field column="altDesc" name="data_tech_alt_desc_i" />
            <field column="altMin" name="data_tech_alt_min_i" />
            <field column="altMax" name="data_tech_alt_max_i" />
            <field column="altMinFacet" name="data_tech_alt_min_facet_is" />
            <field column="altMaxFacet" name="data_tech_alt_max_facet_is" />
            <field column="dist" name="data_tech_dist_f" />
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            <!--            <field column="dur" name="data_tech_dur_f" />   -->
            <field column="countImages" name="count_images_i" />
            <field column="countImagesTop" name="count_images_top_i" />
            <field column="countRoutes" name="count_routes_i" />
            <field column="countTracks" name="count_tracks_i" />
            <field column="countVideos" name="count_videos_i" />

            <!-- child='true' -->
            <entity name="trip_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=TRIP_" || tr_id || ":::name=" || COALESCE(tr_name, "null") || ":::navtype=PREDECESSOR") AS navigation_objects
                            FROM trip
                            WHERE tr_datevon &lt; (SELECT tr_datevon FROM trip WHERE tr_id IN (${trip.tr_id}))
                            ORDER BY tr_datevon DESC, tr_id DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=TRIP_" || tr_id || ":::name=" || COALESCE(tr_name, "null") || ":::navtype=SUCCESSOR") AS navigation_objects
                            FROM trip
                            WHERE tr_datevon &gt; (SELECT tr_datevon FROM trip WHERE tr_id IN (${trip.tr_id}))
                            ORDER BY tr_datevon, tr_id LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="trip_extended_object_properties"
                    query='
                        SELECT "category=ENTITYCOUNT:::name=ROUTE_COUNT:::value=" || CAST(countRoutes AS CHAR) AS extended_object_properties
                              FROM trip
                              WHERE trip.tr_id IN (${trip.tr_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=TRACK_COUNT:::value=" || CAST(countTracks AS CHAR) AS extended_object_properties
                              FROM trip
                              WHERE trip.tr_id IN (${trip.tr_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_COUNT:::value=" || CAST(countImages AS CHAR) AS extended_object_properties
                              FROM trip
                              WHERE trip.tr_id IN (${trip.tr_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_TOP_COUNT:::value=" || CAST(countImagesTop AS CHAR) AS extended_object_properties
                              FROM trip
                              WHERE trip.tr_id IN (${trip.tr_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=VIDEO_COUNT:::value=" || CAST(countVideos AS CHAR) AS extended_object_properties
                              FROM trip
                              WHERE trip.tr_id IN (${trip.tr_id})
                    '>
                <field column="extended_object_properties" name="extended_object_properties_txt"/>
            </entity>

            <entity name="trip_linkedplaylists"
                    query='
                        SELECT playlist.p_id, playlist.p_name, trip_playlist.trp_pos,
                           "type=playlist:::name=" || COALESCE(p_name, "null") || ":::refId=", CAST(playlist.p_id AS CHAR) ||
                           ":::position=" || COALESCE(trip_playlist.trp_pos, "null")
                          AS linkedplaylists
                          FROM playlist INNER JOIN trip_playlist ON playlist.p_id = trip_playlist.p_id WHERE trip_playlist.tr_id IN (${trip.tr_id})
                          ORDER BY p_name'>
                <field column="p_id" name="playlist_id_is"/>
                <field column="p_name" name="playlists_txt"/>
                <field column="trp_pos" name="position_is"/>
                <field column="linkedplaylists" name="linkedplaylists_txt"/>
            </entity>

            <entity name="trip_image"
                    query="
                        SELECT i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url
                        FROM image
                        WHERE k_id in (select k_id FROM kategorie_full WHERE tr_id in (${trip.tr_id}))
                            AND COALESCE(I_PERSONS, '') = ''
                        ORDER BY I_RATE_MOTIVE DESC, I_RATE_WICHTIGKEIT DESC, I_RATE DESC, I_ID DESC
                        limit 10"
                    deltaImportQuery="
                        SELECT i_id, i_date || 'Z' AS i_calced_path AS i_url
                        FROM image WHERE i_id='${dih.delta.id}'"
                    deltaQuery="SELECT i_id FROM image'"
            >
                <field column="i_id" name="i_fav_id_is" />
                <field column="i_date" name="i_fav_i_date_dts" />
                <field column="i_url" name="i_fav_url_txt" />
            </entity>

            <entity name="trip_tour"
                    query="
                        SELECT t_id, d_id, t_keywords, tour.t_calced_actiontype AS actiontype
                        FROM tour
                        WHERE t_id in (select t_id FROM kategorie_full WHERE tr_id in (${trip.tr_id}))"
                    deltaImportQuery="select t_id, t_keywords FROM tour WHERE t_id='${dih.delta.id}'"
                    deltaQuery="SELECT t_id FROM tour'"
            >
                <field column="d_id" name="destination_id_ss" />
                <field column="t_id" name="tour_id_ss" />
                <field column="actiontype" name="actiontype_ss" />
            </entity>
            <entity name="trip_destination"
                    query="
                        SELECT destination.d_id, d_keywords, destination.d_calced_actiontype AS actiontype
                        FROM destination inner join tour ON destination.d_id=tour.d_id
                        WHERE t_id in (select t_id FROM kategorie_full WHERE tr_id in (${trip.tr_id}))"
                    deltaImportQuery="select d_id, d_keywords FROM destination WHERE d_id='${dih.delta.id}'"
                    deltaQuery="SELECT d_id FROM destination"
            >
                <field column="destination.d_id" name="destination_id_ss" />
                <field column="actiontype" name="actiontype_ss" />
            </entity>
            <entity name="trip_track"
                    query="
                        SELECT kategorie_full.l_id,
                               k_id,
                               n_id,
                               k_calced_actiontype AS actiontype,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               t_id,
                               k_keywords,
                               k_persons,
                               k_objects,
                               l_lochirarchietxt,
                               l_lochirarchieids
                        FROM kategorie_full,
                             location
                        WHERE kategorie_full.l_id = location.l_id
                          AND tr_id in (${trip.tr_id})
                        ORDER BY k_datevon asc"
                    deltaImportQuery="
                        SELECT kategorie_full.l_id,
                               k_id,
                               n_id,
                               k_calced_actiontype AS actiontype,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               t_id,
                               k_keywords,
                               k_persons,
                               k_objects,
                               l_lochirarchietxt,
                               l_lochirarchieids
                        FROM kategorie_full,
                             location
                        WHERE kategorie_full.l_id = location.l_id
                          AND k_id = '${dih.delta.id}'"
                    deltaQuery="SELECT k_id FROM kategorie_full'"
                    transformer="HTMLStripTransformer,RegexTransformer"
            >
                <field column="l_id" name="loc_id_is"/>
                <field column="k_id" name="track_id_is"/>
                <field column="t_id" name="route_id_is"/>
                <field column="n_id" name="news_id_is"/>
                <field column="actiontype" name="actiontype_ss" />
                <field column="k_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_datevon" name="date_dts" />
                <field column="week" name="week_is" />
                <field column="month" name="month_is" />
                <field column="year" name="year_is" />
                <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
                <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
                <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
                <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            </entity>

        </entity>

        <entity name="news"
                pk="id"
                query="
                    SELECT DISTINCT news.n_id,
                                    'NEWS'                                                   AS type,
                                    news.n_calced_id                          AS id,
                                    news.countImages,
                                    news.countImagesTop,
                                    news.countRoutes,
                                    news.countTracks,
                                    news.countTrips,
                                    news.countVideos,
                                    n_date || 'Z' AS n_date,
                                    n_date || 'Z'                                                   AS dateshow,
                                    DATETIME(n_date)             AS dateonly,
                                    'DONE' || (n_date IS NOT NULL)                     AS done,
                                    n_headline,
                                    n_message_md,
                                    n_message_html,
                                    n_message_html                                           AS n_message_html2,
                                    n_headline || ' ' || n_keywords || ' ' || n_message_html AS html,
                                    n_keywords,
                                    n_persons,
                                    n_objects,
                                    SUM(K_ALTITUDE_ASC)                                      AS altAsc,
                                    SUM(K_ALTITUDE_DESC)                                     AS altDesc,
                                    MAX(K_ALTITUDE_MAX)                                      AS altMax,
                                    MAX(ROUND((K_ALTITUDE_MAX / 500)) * 500)                 AS altMaxFacet,
                                    MIN(K_ALTITUDE_MIN)                                      AS altMin,
                                    MIN(ROUND((K_ALTITUDE_MIN / 500)) * 500)                 AS altMinFacet,
                                    SUM(K_DISTANCE)                                          AS dist
                    FROM news
                             LEFT JOIN kategorie_full ON news.n_id = kategorie_full.n_id
                    GROUP BY news.n_id, type, id, n_date, dateshow, dateonly, n_headline, n_message_md, n_message_html, n_message_html2,
                             html, n_keywords
                    ORDER BY n_date"
                deltaImportQuery="
                    SELECT DISTINCT news.n_id,
                                    'NEWS'                                                   AS type,
                                    news.n_calced_id                          AS id,
                                    news.countImages,
                                    news.countImagesTop,
                                    news.countRoutes,
                                    news.countTracks,
                                    news.countTrips,
                                    news.countVideos,
                                    n_date || 'Z' AS n_date,
                                    n_date || 'Z'                                                   AS dateshow,
                                    DATETIME(n_date)             AS dateonly,
                                    'DONE' || (n_date IS NOT NULL)                     AS done,
                                    n_headline,
                                    n_message_md,
                                    n_message_html,
                                    n_message_html                                           AS n_message_html2,
                                    n_headline || ' ' || n_keywords || ' ' || n_message_html AS html,
                                    n_keywords,
                                    n_persons,
                                    n_objects,
                                    SUM(K_ALTITUDE_ASC)                                      AS altAsc,
                                    SUM(K_ALTITUDE_DESC)                                     AS altDesc,
                                    MAX(K_ALTITUDE_MAX)                                      AS altMax,
                                    MAX(ROUND((K_ALTITUDE_MAX / 500)) * 500)                 AS altMaxFacet,
                                    MIN(K_ALTITUDE_MIN)                                      AS altMin,
                                    MIN(ROUND((K_ALTITUDE_MIN / 500)) * 500)                 AS altMinFacet,
                                    SUM(K_DISTANCE)                                          AS dist
                    FROM news
                             LEFT JOIN kategorie_full ON news.n_id = kategorie_full.n_id
                    WHERE news.n_id = '${dih.delta.id}'
                    GROUP BY news.n_id, type, id, n_date, dateshow, dateonly, n_headline, n_message_md, n_message_html, n_message_html2,
                             html, n_keywords"
                deltaQuery="SELECT n_id FROM info ORDER BY n_id'"
                transformer="HTMLStripTransformer,RegexTransformer"
        >
            <field column="id" name="id"/>
            <field column="n_id" name="news_id_i"/>
            <field column="n_id" name="news_id_is"/>

            <field column="n_headline" name="name_s" stripHTML="true" />
            <field column="n_headline" name="name_txt" stripHTML="true" />
            <field column="n_message_html" name="desc_txt" stripHTML="true" />
            <field column="n_message_md" name="desc_md_txt" stripHTML="false" />
            <field column="html" name="html_txt" />
            <field column="n_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
            <field column="n_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
            <field column="n_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
            <field column="n_date" name="dateshow_dt" />
            <field column="n_date" name="datesort_dt" />
            <field column="n_date" name="date_dt" />
            <field column="dateonly" name="dateonly_s" />
            <field column="done" name="done_ss" />
            <field column="type" name="type_s" />
            <field column="type" name="type_txt" />
            <field column="altAsc" name="data_tech_alt_asc_i" />
            <field column="altDesc" name="data_tech_alt_desc_i" />
            <field column="altMin" name="data_tech_alt_min_i" />
            <field column="altMax" name="data_tech_alt_max_i" />
            <field column="altMinFacet" name="data_tech_alt_min_facet_is" />
            <field column="altMaxFacet" name="data_tech_alt_max_facet_is" />
            <field column="dist" name="data_tech_dist_f" />
            <field column="countImages" name="count_images_i" />
            <field column="countImagesTop" name="count_images_top_i" />
            <field column="countRoutes" name="count_routes_i" />
            <field column="countTracks" name="count_tracks_i" />
            <field column="countTrips" name="count_trips_i" />
            <field column="countVideos" name="count_videos_i" />

            <!-- child='true' -->
            <entity name="news_navigation_objects"
                    query='
                        SELECT navigation_objects FROM (SELECT ("navid=NEWS_" || n_id || ":::name=" || COALESCE(n_headline, "null") || ":::navtype=PREDECESSOR") AS navigation_objects
                            FROM news
                            WHERE n_datevon &lt; (SELECT n_datevon FROM news WHERE n_id IN (${news.n_id}))
                            ORDER BY n_datevon DESC, n_id DESC LIMIT 1
                        )
                        UNION
                        SELECT navigation_objects FROM (SELECT ("navid=NEWS_" || n_id || ":::name=" || COALESCE(n_headline, "null") || ":::navtype=SUCCESSOR") AS navigation_objects
                            FROM news
                            WHERE n_datevon &gt; (SELECT n_datevon FROM news WHERE n_id IN (${news.n_id}))
                            ORDER BY n_datevon, n_id LIMIT 1
                        )'>
                <field column="navigation_objects" name="navigation_objects_txt"/>
            </entity>

            <entity name="news_extended_object_properties"
                    query='
                        SELECT "category=ENTITYCOUNT:::name=ROUTE_COUNT:::value=" || CAST(countRoutes AS CHAR) AS extended_object_properties
                              FROM news
                              WHERE news.n_id IN (${news.n_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=TRIP_COUNT:::value=" || CAST(countTrips AS CHAR) AS extended_object_properties
                              FROM news
                              WHERE news.n_id IN (${news.n_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=TRACK_COUNT:::value=" || CAST(countTracks AS CHAR) AS extended_object_properties
                              FROM news
                              WHERE news.n_id IN (${news.n_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_COUNT:::value=" || CAST(countImages AS CHAR) AS extended_object_properties
                              FROM news
                              WHERE news.n_id IN (${news.n_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=IMAGE_TOP_COUNT:::value=" || CAST(countImagesTop AS CHAR) AS extended_object_properties
                              FROM news
                              WHERE news.n_id IN (${news.n_id})
                           UNION
                        SELECT "category=ENTITYCOUNT:::name=VIDEO_COUNT:::value=" || CAST(countVideos AS CHAR) AS extended_object_properties
                              FROM news
                              WHERE news.n_id IN (${news.n_id})
                    '>
                <field column="extended_object_properties" name="extended_object_properties_txt"/>
            </entity>

            <entity name="news_image"
                    query="
                        SELECT i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url
                        FROM image
                        WHERE k_id in (select k_id FROM kategorie_full WHERE n_id in (${news.n_id}))
                        ORDER BY I_RATE_MOTIVE desc, I_RATE_WICHTIGKEIT desc, I_RATE desc, I_ID desc
                        limit 10"
                    deltaImportQuery="
                        SELECT i_id, i_date || 'Z' AS i_date, i_calced_path AS i_url
                        FROM image WHERE i_id='${dih.delta.id}'"
                    deltaQuery="SELECT i_id FROM image'"
            >
                <field column="i_id" name="i_fav_id_is" />
                <field column="i_date" name="i_fav_i_date_dts" />
                <field column="i_url" name="i_fav_url_txt" />
            </entity>
            <entity name="news_tour"
                    query="
                        SELECT tour.t_id, tour.d_id, t_keywords, tour.t_calced_actiontype AS actiontype
                          FROM news
                          INNER JOIN kategorie_full ON (kategorie_full.n_id = news.n_id)
                          INNER JOIN kategorie_tour ON kategorie_tour.k_id = kategorie_full.k_id
                          INNER JOIN tour ON kategorie_tour.t_id = tour.t_id
                          WHERE news.n_id IN (${news.n_id})"
                    deltaImportQuery="select t_id, t_keywords FROM tour WHERE t_id='${dih.delta.id}'"
                    deltaQuery="SELECT t_id FROM tour'"
            >
                <field column="t_id" name="route_id_is"/>
                <field column="d_id" name="destination_id_ss" />
                <field column="actiontype" name="actiontype_ss" />
            </entity>
            <entity name="news_destination"
                    query="
                        SELECT destination.d_id, d_keywords,  destination.d_calced_actiontype AS actiontype
                          FROM news
                          INNER JOIN kategorie_full ON (kategorie_full.n_id = news.n_id)
                          INNER JOIN kategorie_tour ON kategorie_tour.k_id = kategorie_full.k_id
                          INNER JOIN tour ON kategorie_tour.t_id = tour.t_id
                          INNER JOIN destination ON destination.d_id=tour.d_id
                          WHERE news.n_id IN (${news.n_id})"
                    deltaImportQuery="select d_id, d_keywords FROM destination WHERE d_id='${dih.delta.id}'"
                    deltaQuery="SELECT d_id FROM destination"
            >
                <field column="destination.d_id" name="destination_id_ss" />
                <field column="actiontype" name="actiontype_ss" />
            </entity>
            <entity name="news_track"
                    query="
                        SELECT kategorie_full.l_id,
                               k_id,
                               tr_id,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               t_id,
                               k_keywords,
                               k_persons,
                               k_objects,
                               l_lochirarchietxt,
                               l_lochirarchieids
                        FROM kategorie_full,
                             location
                        WHERE kategorie_full.l_id = location.l_id
                          AND n_id in (${news.n_id})
                        ORDER BY k_datevon asc"
                    deltaImportQuery="
                        SELECT kategorie_full.l_id,
                               k_id,
                               tr_id,
                               k_dateshow || 'Z' AS k_dateshow,
                               k_datevon || 'Z' AS k_datevon,
                               k_calced_week  AS week,
                               k_calced_month AS month,
                               k_calced_year  AS year,
                               t_id,
                               k_keywords,
                               k_persons,
                               k_objects,
                               l_lochirarchietxt,
                               l_lochirarchieids
                        FROM kategorie_full,
                             location
                        WHERE kategorie_full.l_id = location.l_id
                          AND k_id = '${dih.delta.id}'"
                    deltaQuery="SELECT k_id FROM kategorie_full'"
                    transformer="HTMLStripTransformer,RegexTransformer"
            >
                <field column="l_id" name="loc_id_is"/>
                <field column="t_id" name="route_id_is"/>
                <field column="k_id" name="track_id_is"/>
                <field column="tr_id" name="trip_id_is"/>
                <field column="k_keywords" name="keywords_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_persons" name="persons_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_objects" name="objects_txt" regex="[ ]+" replaceWith=" " />
                <field column="k_datevon" name="date_dts" />
                <field column="week" name="week_is" />
                <field column="month" name="month_is" />
                <field column="year" name="year_is" />
                <field column="l_lochirarchieids" name="loc_lochirarchie_ids_s" regex="[ ]+" replaceWith="_"/>
                <field column="l_lochirarchieids" name="loc_lochirarchie_ids_txt" regex="[ ]+" replaceWith="_"/>
                <field column="l_lochirarchietxt" name="loc_lochirarchie_s" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
                <field column="l_lochirarchietxt" name="loc_lochirarchie_txt" regex="[- \/()+;\.]+(?!\\n)|(([a-zA-Z0-9 _]),{1,1}(?!,))|(^ ,{1,1}(?!,))" replaceWith="$2_"/>
            </entity>
        </entity>
    </document>

</dataConfig>

